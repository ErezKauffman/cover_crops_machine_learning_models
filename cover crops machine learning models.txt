

machine learning for classification problem

#background: cover crop are essentials crops that are benefits in
different ways like: -maintain soil structure and prevent soil erosion
due to rain. -enrich the soil with organic compounds and nitrogen fixing
bacteria. -maintain the soil bacteria population. -prevents weeds
consolidation.

#the problem: farmers are encourgah to maintain cover crops from the
beginning of July-early April or until main crop plantation. Germany
gives Subsidies to farmers based on the cover crops establishment. to
make this happen, field technicans are reaching to each field few times
a years in order to estimate cover crop plantation.

#the solution: A machine learning model for classification was developed
using NDVI data from sentinel 2 satellite. this data was evaluated in
comparison to field tagging. based on that, a training model implemented
to evaluate the next year cover crop plantation (1-yes,0-no).

    #import packages
    import pandas as pd
    import numpy as np
    %matplotlib inline
    import seaborn as sns
    import matplotlib.pyplot as plt
    plt.style.use('seaborn')
    import sklearn as scipy
    import warnings
    import sklearn.metrics as metrics
    from sklearn.metrics import confusion_matrix
    from sklearn.metrics import accuracy_score
    warnings.filterwarnings("ignore")

    #upload the test dataset
    test_df= pd.read_csv('C:\\Users\\97252\\Downloads\\winter catch crop monitoring\\my_analysis\\winter_catch_crop_detection\\df_cc_test_final(pre-one hot encodding).csv')
    test_df.head()

       area  ndvi_min_182_365  ndvi_max_182_365  ndvi_mean_182_365  \
    0     1              0.23              0.99               0.71   
    1     1              0.49              0.99               0.68   
    2     1              0.38              0.99               0.61   
    3     1              0.25              0.99               0.59   
    4     1              0.25              0.99               0.58   

       ndvi_mean_var_182_365  ndvi_trend_196_273  ndvi_trend_213_258  \
    0                 0.0279              0.0011              0.0021   
    1                 0.0169              0.0006              0.0005   
    2                 0.0357              0.0005              0.0029   
    3                 0.0531              0.0051              0.0095   
    4                 0.0402              0.0046              0.0088   

       ndvi_trend_274_332  ndvi_sum_232_272  ndvi_sum_278_348  ndvi_sum_001_046  \
    0              0.0012              24.0              59.0              28.0   
    1              0.0015              25.0              53.0              33.0   
    2              0.0071              22.0              52.0              30.0   
    3             -0.0015              20.0              54.0              26.0   
    4              0.0010              21.0              55.0              34.0   

       doy_ndvi_max_182_365  doy_ndvi_min_182_365  rpearson_ts_sim_182_365  \
    0                 345.0                 268.0                     0.67   
    1                 345.0                 185.0                     0.77   
    2                 323.0                 303.0                     0.76   
    3                 345.0                 218.0                     0.89   
    4                 345.0                 218.0                     0.75   

       rpearson_ts_sim_1_120  doy_first_level_shift_182_365  \
    0                  -0.47                            0.0   
    1                  -0.14                            0.0   
    2                   0.95                          290.0   
    3                  -0.34                          185.0   
    4                   0.79                            0.0   

       number_level_shifts_182_365  doy_first_level_shift_001_120  \
    0                          0.0                           20.0   
    1                          0.0                           20.0   
    2                          1.0                           40.0   
    3                          2.0                           22.0   
    4                          0.0                            0.0   

       doy_changepoint_182_365  doy_changepoint_001_120  min_temp_july  \
    0                    270.0                     54.0          10.95   
    1                    309.0                     19.0          10.95   
    2                    313.0                     66.0          11.25   
    3                    258.0                     41.0          10.95   
    4                    254.0                     33.0          10.95   

       min_temp_aug  min_temp_sep  min_temp_oct  min_temp_nov  min_temp_dec  \
    0         10.33          6.70          3.64          0.98          1.72   
    1         10.33          6.70          3.64          0.98          1.72   
    2          9.51          7.64          6.93          2.17          1.18   
    3         10.33          6.70          3.64          0.98          1.72   
    4         10.33          6.70          3.64          0.98          1.72   

       min_temp_jan  min_temp_feb  min_temp_march  max_temp_july  max_temp_aug  \
    0         -1.98         -0.89            1.85      26.799999     25.379999   
    1         -1.98         -0.89            1.85      26.799999     25.379999   
    2          0.12         -6.10           -2.76      21.580000     21.709999   
    3         -1.98         -0.89            1.85      26.799999     25.379999   
    4         -1.98         -0.89            1.85      26.799999     25.379999   

       max_temp_sep  max_temp_oct  max_temp_nov  max_temp_dec  max_temp_jan  \
    0     20.969999         15.85          8.03          6.44          3.66   
    1     20.969999         15.85          8.03          6.44          3.66   
    2     17.660000         14.64          7.81          5.15          5.40   
    3     20.969999         15.85          8.03          6.44          3.66   
    4     20.969999         15.85          8.03          6.44          3.66   

       max_temp_feb  max_temp_march  av_relative_humidity_aug  \
    0          9.24           10.05                 67.370003   
    1          9.24           10.05                 67.370003   
    2          1.72            5.67                 80.639999   
    3          9.24           10.05                 67.370003   
    4          9.24           10.05                 67.370003   

       av_relative_humidity_nov  av_relative_humidity_dec  \
    0                 88.510002                 91.379997   
    1                 88.510002                 91.379997   
    2                 92.040001                 90.660004   
    3                 88.510002                 91.379997   
    4                 88.510002                 91.379997   

       av_relative_humidity_jan  av_relative_humidity_feb  \
    0                 87.769997                 79.050003   
    1                 87.769997                 79.050003   
    2                 89.160004                 80.900002   
    3                 87.769997                 79.050003   
    4                 87.769997                 79.050003   

       av_relative_humidity_march  precipitation_july  precipitation_aug  \
    0                   80.559998           41.700001          27.799999   
    1                   80.559998           41.700001          27.799999   
    2                   77.080002          129.699997          72.300003   
    3                   80.559998           41.700001          27.799999   
    4                   80.559998           41.700001          27.799999   

       precipitation_oct  precipitation_nov  precipitation_dec  precipitation_jan  \
    0          40.099998               13.1         104.599998          83.500000   
    1          40.099998               13.1         104.599998          83.500000   
    2          88.699997               75.5          74.300003          99.300003   
    3          40.099998               13.1         104.599998          83.500000   
    4          40.099998               13.1         104.599998          83.500000   

       precipitation_feb  precipitation_march  av_soil_temp_july  \
    0          23.799999            78.699997          23.153091   
    1          23.799999            78.699997          23.153091   
    2           4.700000            45.799999          18.978226   
    3          23.799999            78.699997          23.153091   
    4          23.799999            78.699997          23.153091   

       av_soil_temp_aug  av_soil_temp_sep  av_soil_temp_oct  av_soil_temp_nov  \
    0         22.164381         16.522223         11.106989          5.841667   
    1         22.164381         16.522223         11.106989          5.841667   
    2         18.377419         14.752778         11.831586          6.528750   
    3         22.164381         16.522223         11.106989          5.841667   
    4         22.164381         16.522223         11.106989          5.841667   

       av_soil_temp_dec  av_soil_temp_jan  av_soil_temp_feb  av_soil_temp_march  \
    0          4.535349          2.118414          4.116667            6.099597   
    1          4.535349          2.118414          4.116667            6.099597   
    2          3.746909          3.150269          0.372917            2.206317   
    3          4.535349          2.118414          4.116667            6.099597   
    4          4.535349          2.118414          4.116667            6.099597   

       sunshine_duration_july  sunshine_duration_aug  sunshine_duration_sep  \
    0              311.549988             229.050003             186.199997   
    1              311.549988             229.050003             186.199997   
    2              171.550003             171.100006             112.080002   
    3              311.549988             229.050003             186.199997   
    4              311.549988             229.050003             186.199997   

       sunshine_duration_oct  sunshine_duration_nov  sunshine_duration_dec  \
    0             151.529999                  59.73              20.879999   
    1             151.529999                  59.73              20.879999   
    2              77.790001                  23.25              12.520000   
    3             151.529999                  59.73              20.879999   
    4             151.529999                  59.73              20.879999   

       sunshine_duration_jan  sunshine_duration_feb  sunshine_duration_march  \
    0              46.580002             116.199997                75.199997   
    1              46.580002             116.199997                75.199997   
    2              24.320000             118.000000               105.019997   
    3              46.580002             116.199997                75.199997   
    4              46.580002             116.199997                75.199997   

       ndvi_min_max_ratio_182_365  relative_precipitation_01_90  \
    0                    0.232323                      2.066667   
    1                    0.494949                      2.066667   
    2                    0.383838                      1.664444   
    3                    0.252525                      2.066667   
    4                    0.252525                      2.066667   

       ndvi_trend_sum_196_332  ndvi_sum_278_046  ndvi_min_182_365_rank  \
    0                  0.0023              87.0                 5348.0   
    1                  0.0021              86.0                  291.0   
    2                  0.0076              82.0                 1108.0   
    3                  0.0036              80.0                 4335.0   
    4                  0.0056              89.0                 4335.0   

       ndvi_mean_182_365_rank  ndvi_max_182_365_rank  mean_temp_july  \
    0                   213.0                    1.0          18.875   
    1                   469.0                    1.0          18.875   
    2                  1862.0                    1.0          16.415   
    3                  2534.0                    1.0          18.875   
    4                  2921.0                    1.0          18.875   

       mean_temp_aug  mean_temp_sep  mean_temp_oct  mean_temp_nov  mean_temp_dec  \
    0         17.855         13.835          9.745          4.505          4.080   
    1         17.855         13.835          9.745          4.505          4.080   
    2         15.610         12.650         10.785          4.990          3.165   
    3         17.855         13.835          9.745          4.505          4.080   
    4         17.855         13.835          9.745          4.505          4.080   

       mean_temp_jan  mean_temp_feb  mean_temp_march  min_temp_182_365  \
    0           0.84          4.175            5.950          5.720000   
    1           0.84          4.175            5.950          5.720000   
    2           2.76         -2.190            1.455          6.446667   
    3           0.84          4.175            5.950          5.720000   
    4           0.84          4.175            5.950          5.720000   

       min_temp_01_90  max_temp_182_365  max_temp_01_90  \
    0       -0.340000         17.245000        7.650000   
    1       -0.340000         17.245000        7.650000   
    2       -2.913333         14.758333        4.263333   
    3       -0.340000         17.245000        7.650000   
    4       -0.340000         17.245000        7.650000   

       av_relative_humidity_01_90  av_precipitation_01_90  av_soil_temp_182_365  \
    0                   82.459999               61.999999             13.887283   
    1                   82.459999               61.999999             13.887283   
    2                   82.380002               49.933334             12.369278   
    3                   82.459999               61.999999             13.887283   
    4                   82.459999               61.999999             13.887283   

       av_soil_temp_01_90  av_soil_temp_sum_182_365  av_soil_temp_sum_01_90  \
    0            4.111559                 83.323700               12.334678   
    1            4.111559                 83.323700               12.334678   
    2            1.909834                 74.215667                5.729503   
    3            4.111559                 83.323700               12.334678   
    4            4.111559                 83.323700               12.334678   

       sunshine_duration_sum_182_365  sunshine_duration_sum_01_90  \
    0                     958.939985                   237.979996   
    1                     958.939985                   237.979996   
    2                     568.290012                   247.339996   
    3                     958.939985                   237.979996   
    4                     958.939985                   237.979996   

       av_sunshine_duration_182_365  av_sunshine_duration_01_90  \
    0                    159.823331                   79.326665   
    1                    159.823331                   79.326665   
    2                     94.715002                   82.446665   
    3                    159.823331                   79.326665   
    4                    159.823331                   79.326665   

       min_max_temp_ratio_182_365  mean_temp_182_365  mean_temp_01_90  \
    0                    0.331690            11.4825            3.655   
    1                    0.331690            11.4825            3.655   
    2                    0.436815            10.6025            0.675   
    3                    0.331690            11.4825            3.655   
    4                    0.331690            11.4825            3.655   

       mean_temp_to_av_precipitation_ratio_01_90  \
    0                                   0.112876   
    1                                   0.112876   
    2                                   0.021128   
    3                                   0.112876   
    4                                   0.112876   

       av_soil_temp_to_av_precipitation_ratio_01_90  \
    0                                      0.066315   
    1                                      0.066315   
    2                                      0.038248   
    3                                      0.066315   
    4                                      0.066315   

       sunshine_dur_to_av_precipitation_ratio_01_90 av_relative_humidity_july  \
    0                                      1.279462                     63-77   
    1                                      1.279462                     63-77   
    2                                      1.651135                     77-81   
    3                                      1.279462                     63-77   
    4                                      1.279462                     63-77   

      av_relative_humidity_sep av_relative_humidity_oct precipitation_sep  \
    0                  Missing                    62-69             30-50   
    1                  Missing                    62-69             30-50   
    2                    62-69                    62-69             70-90   
    3                  Missing                    62-69             30-50   
    4                  Missing                    62-69             30-50   

      relative_precipitation_182_365 av_relative_humidity_182_365  \
    0                            1-2                      Missing   
    1                            1-2                      Missing   
    2                            2-3                        81-87   
    3                            1-2                      Missing   
    4                            1-2                      Missing   

      av_precipitation_182_365 mean_temp_to_av_precipitation_ratio_182_365  \
    0                      low                                         mid   
    1                      low                                         mid   
    2                     high                                         low   
    3                      low                                         mid   
    4                      low                                         mid   

      av_soil_temp_to_av_precipitation_ratio_182_365  \
    0                                            mid   
    1                                            mid   
    2                                            low   
    3                                            mid   
    4                                            mid   

      sunshine_dur_to_av_precipitation_ratio_182_365  class  
    0                                          0-0.3      0  
    1                                          0-0.3      0  
    2                                          0-0.3      1  
    3                                          0-0.3      1  
    4                                          0-0.3      0  

    #suffle the database in order to prepare for train and validation dataframe
    test_df= test_df.sample(frac=1)
    pd.set_option("display.max_columns", 117)
    display(test_df)

           area  ndvi_min_182_365  ndvi_max_182_365  ndvi_mean_182_365  \
    992       2              0.06              0.88               0.53   
    9114      2              0.43              0.75               0.56   
    6448      1              0.14              0.80               0.35   
    11990     0             -0.04              0.64               0.30   
    12778     0              0.12              0.58               0.38   
    ...     ...               ...               ...                ...   
    3783      2              0.18              0.83               0.48   
    1879      2              0.49              0.86               0.74   
    6341      2             -0.05              0.80               0.45   
    5961      2              0.42              0.80               0.62   
    11891     0              0.38              0.64               0.53   

           ndvi_mean_var_182_365  ndvi_trend_196_273  ndvi_trend_213_258  \
    992                   0.0537              0.0000              0.0034   
    9114                  0.0090              0.0034              0.0033   
    6448                  0.0508             -0.0001              0.0001   
    11990                 0.0297             -0.0065             -0.0051   
    12778                 0.0247             -0.0001             -0.0020   
    ...                      ...                 ...                 ...   
    3783                  0.0732              0.0010              0.0022   
    1879                  0.0048              0.0000              0.0000   
    6341                  0.0666              0.0013              0.0086   
    5961                  0.0058             -0.0010              0.0008   
    11891                 0.0057             -0.0017              0.0001   

           ndvi_trend_274_332  ndvi_sum_232_272  ndvi_sum_278_348  \
    992               -0.0003              13.0              54.0   
    9114              -0.0029              28.0              36.0   
    6448               0.0083               6.0              35.0   
    11990              0.0008              11.0              12.0   
    12778             -0.0054              21.0              17.0   
    ...                   ...               ...               ...   
    3783               0.0038              10.0              52.0   
    1879               0.0004              30.0              54.0   
    6341              -0.0049              13.0              44.0   
    5961              -0.0013              24.0              43.0   
    11891             -0.0043              22.0              33.0   

           ndvi_sum_001_046  doy_ndvi_max_182_365  doy_ndvi_min_182_365  \
    992                31.0                 288.0                 273.0   
    9114               21.0                 268.0                 323.0   
    6448               28.0                 320.0                 200.0   
    11990              13.0                 182.0                 297.0   
    12778               9.0                 262.0                 334.0   
    ...                 ...                   ...                   ...   
    3783               25.0                 338.0                 230.0   
    1879               19.0                 288.0                 303.0   
    6341               32.0                 288.0                 323.0   
    5961               26.0                 236.0                 336.0   
    11891              21.0                 182.0                 324.0   

           rpearson_ts_sim_182_365  rpearson_ts_sim_1_120  \
    992                       0.86                   0.86   
    9114                     -0.37                  -0.62   
    6448                      0.75                   0.95   
    11990                    -0.82                  -0.74   
    12778                    -0.87                   0.49   
    ...                        ...                    ...   
    3783                      0.92                   0.92   
    1879                     -0.05                   0.85   
    6341                      0.70                   0.85   
    5961                     -0.31                  -0.80   
    11891                    -0.87                   0.88   

           doy_first_level_shift_182_365  number_level_shifts_182_365  \
    992                            280.0                          1.0   
    9114                           270.0                          3.0   
    6448                             0.0                          0.0   
    11990                          291.0                          2.0   
    12778                            0.0                          0.0   
    ...                              ...                          ...   
    3783                             0.0                          0.0   
    1879                           290.0                          2.0   
    6341                           330.0                          1.0   
    5961                             0.0                          0.0   
    11891                          214.0                          3.0   

           doy_first_level_shift_001_120  doy_changepoint_182_365  \
    992                              0.0                    276.0   
    9114                            58.0                    287.0   
    6448                             0.0                    283.0   
    11990                           79.0                    231.0   
    12778                          109.0                    296.0   
    ...                              ...                      ...   
    3783                            80.0                    284.0   
    1879                             0.0                    346.0   
    6341                            80.0                    260.0   
    5961                            83.0                    239.0   
    11891                           34.0                    292.0   

           doy_changepoint_001_120  min_temp_july  min_temp_aug  min_temp_sep  \
    992                       87.0           9.82         10.30          5.59   
    9114                      82.0          11.23          9.84          6.60   
    6448                      40.0          10.95         10.33          6.70   
    11990                     91.0          13.07         13.17          8.77   
    12778                     51.0          12.67         12.07          7.63   
    ...                        ...            ...           ...           ...   
    3783                      34.0           9.95         10.23          5.54   
    1879                      33.0          11.23          9.84          6.60   
    6341                      83.0           9.82         10.30          5.59   
    5961                      80.0           9.82         10.30          5.59   
    11891                     37.0          12.67         12.07          7.63   

           min_temp_oct  min_temp_nov  min_temp_dec  min_temp_jan  min_temp_feb  \
    992            5.36          0.44         -0.95         -0.82          0.57   
    9114           6.45          1.22         -0.03          0.18         -8.64   
    6448           3.64          0.98          1.72         -1.98         -0.89   
    11990          3.93          0.70          0.66         -2.61         -1.84   
    12778          6.52          1.09         -1.07         -0.79         -7.69   
    ...             ...           ...           ...           ...           ...   
    3783           3.01          0.43          0.60         -3.26         -2.52   
    1879           6.45          1.22         -0.03          0.18         -8.64   
    6341           5.36          0.44         -0.95         -0.82          0.57   
    5961           5.36          0.44         -0.95         -0.82          0.57   
    11891          6.52          1.09         -1.07         -0.79         -7.69   

           min_temp_march  max_temp_july  max_temp_aug  max_temp_sep  \
    992             -2.25      23.790001     25.510000     19.600000   
    9114            -3.34      23.040001     22.480000     17.730000   
    6448             1.85      26.799999     25.379999     20.969999   
    11990            0.86      28.440001     28.000000     22.969999   
    12778           -4.29      23.760000     24.030001     18.510000   
    ...               ...            ...           ...           ...   
    3783             0.25      27.549999     26.770000     21.680000   
    1879            -3.34      23.040001     22.480000     17.730000   
    6341            -2.25      23.790001     25.510000     19.600000   
    5961            -2.25      23.790001     25.510000     19.600000   
    11891           -4.29      23.760000     24.030001     18.510000   

           max_temp_oct  max_temp_nov  max_temp_dec  max_temp_jan  max_temp_feb  \
    992           14.98          7.59          6.20          5.91          8.27   
    9114          15.11          7.81          5.27          6.11          1.27   
    6448          15.85          8.03          6.44          3.66          9.24   
    11990         16.25          8.23          6.36          3.39          9.04   
    12778         14.59          8.30          5.36          5.42          2.42   
    ...             ...           ...           ...           ...           ...   
    3783          15.88          8.20          6.28          3.31          9.45   
    1879          15.11          7.81          5.27          6.11          1.27   
    6341          14.98          7.59          6.20          5.91          8.27   
    5961          14.98          7.59          6.20          5.91          8.27   
    11891         14.59          8.30          5.36          5.42          2.42   

           max_temp_march  av_relative_humidity_aug  av_relative_humidity_nov  \
    992             10.17                 69.599998                 90.489998   
    9114             7.02                 79.949997                 90.760002   
    6448            10.05                 67.370003                 88.510002   
    11990           11.12                 58.320000                 85.040001   
    12778            5.70                 76.620003                 92.180000   
    ...               ...                       ...                       ...   
    3783            10.76                 61.139999                 86.820000   
    1879             7.02                 79.949997                 90.760002   
    6341            10.17                 69.599998                 90.489998   
    5961            10.17                 69.599998                 90.489998   
    11891            5.70                 76.620003                 92.180000   

           av_relative_humidity_dec  av_relative_humidity_jan  \
    992                   86.669998                 88.330002   
    9114                  89.169998                 89.089996   
    6448                  91.379997                 87.769997   
    11990                 88.300003                 86.120003   
    12778                 90.139999                 88.809998   
    ...                         ...                       ...   
    3783                  87.019997                 85.930000   
    1879                  89.169998                 89.089996   
    6341                  86.669998                 88.330002   
    5961                  86.669998                 88.330002   
    11891                 90.139999                 88.809998   

           av_relative_humidity_feb  av_relative_humidity_march  \
    992                   79.290001                   71.290001   
    9114                  81.730003                   80.150002   
    6448                  79.050003                   80.559998   
    11990                 72.540001                   76.889999   
    12778                 77.220001                   77.430000   
    ...                         ...                         ...   
    3783                  76.599998                   76.980003   
    1879                  81.730003                   80.150002   
    6341                  79.290001                   71.290001   
    5961                  79.290001                   71.290001   
    11891                 77.220001                   77.430000   

           precipitation_july  precipitation_aug  precipitation_oct  \
    992             69.099998          36.500000          72.199997   
    9114           158.199997          91.000000          54.099998   
    6448            41.700001          27.799999          40.099998   
    11990           51.900002          10.100000          12.500000   
    12778          144.300003          73.800003          74.599998   
    ...                   ...                ...                ...   
    3783            28.100000          21.100000          23.700001   
    1879           158.199997          91.000000          54.099998   
    6341            69.099998          36.500000          72.199997   
    5961            69.099998          36.500000          72.199997   
    11891          144.300003          73.800003          74.599998   

           precipitation_nov  precipitation_dec  precipitation_jan  \
    992            36.400002          76.500000          39.599998   
    9114           79.300003          49.200001          84.900002   
    6448           13.100000         104.599998          83.500000   
    11990          15.400000          38.000000          51.599998   
    12778          62.299999          35.099998          58.400002   
    ...                  ...                ...                ...   
    3783           26.000000          96.599998          90.000000   
    1879           79.300003          49.200001          84.900002   
    6341           36.400002          76.500000          39.599998   
    5961           36.400002          76.500000          39.599998   
    11891          62.299999          35.099998          58.400002   

           precipitation_feb  precipitation_march  av_soil_temp_july  \
    992           125.099998            52.099998          20.346640   
    9114           10.400000            37.400002          18.932528   
    6448           23.799999            78.699997          23.153091   
    11990          23.500000            59.900002          26.486828   
    12778           1.900000            52.500000          22.654167   
    ...                  ...                  ...                ...   
    3783           18.600000            76.400002          22.870296   
    1879           10.400000            37.400002          18.932528   
    6341          125.099998            52.099998          20.346640   
    5961          125.099998            52.099998          20.346640   
    11891           1.900000            52.500000          22.654167   

           av_soil_temp_aug  av_soil_temp_sep  av_soil_temp_oct  av_soil_temp_nov  \
    992           20.362904         15.681666         11.508737          5.924445   
    9114          18.329033         14.912084         11.951210          6.453472   
    6448          22.164381         16.522223         11.106989          5.841667   
    11990         25.511156         18.827917         10.582796          5.031111   
    12778         22.565994         15.948750         11.510080          5.809306   
    ...                 ...               ...               ...               ...   
    3783          22.411291         16.557917         11.350403          6.155000   
    1879          18.329033         14.912084         11.951210          6.453472   
    6341          20.362904         15.681666         11.508737          5.924445   
    5961          20.362904         15.681666         11.508737          5.924445   
    11891         22.565994         15.948750         11.510080          5.809306   

           av_soil_temp_dec  av_soil_temp_jan  av_soil_temp_feb  \
    992            3.660081          3.244758          4.476042   
    9114           3.394624          3.566263          0.615625   
    6448           4.535349          2.118414          4.116667   
    11990          3.491667          1.461156          1.734077   
    12778          2.390591          2.156720         -0.268304   
    ...                 ...               ...               ...   
    3783           4.290457          2.178495          3.133482   
    1879           3.394624          3.566263          0.615625   
    6341           3.660081          3.244758          4.476042   
    5961           3.660081          3.244758          4.476042   
    11891          2.390591          2.156720         -0.268304   

           av_soil_temp_march  sunshine_duration_july  sunshine_duration_aug  \
    992              5.662500              216.149994             225.080002   
    9114             2.336156              178.419998             189.050003   
    6448             6.099597              311.549988             229.050003   
    11990            6.382392              347.299988             280.470001   
    12778            1.086962              220.130005             231.250000   
    ...                   ...                     ...                    ...   
    3783             6.302285              337.799988             244.880005   
    1879             2.336156              178.419998             189.050003   
    6341             5.662500              216.149994             225.080002   
    5961             5.662500              216.149994             225.080002   
    11891            1.086962              220.130005             231.250000   

           sunshine_duration_sep  sunshine_duration_oct  sunshine_duration_nov  \
    992               155.800003             103.250000              38.599998   
    9114              101.699997              94.419998              28.430000   
    6448              186.199997             151.529999              59.730000   
    11990             215.399994             168.419998              68.279999   
    12778             160.970001              81.279999              52.520000   
    ...                      ...                    ...                    ...   
    3783              205.970001             144.220001              63.830002   
    1879              101.699997              94.419998              28.430000   
    6341              155.800003             103.250000              38.599998   
    5961              155.800003             103.250000              38.599998   
    11891             160.970001              81.279999              52.520000   

           sunshine_duration_dec  sunshine_duration_jan  sunshine_duration_feb  \
    992                62.049999              47.380001              68.300003   
    9114               18.969999              27.920000             115.849998   
    6448               20.879999              46.580002             116.199997   
    11990              19.680000              58.110001             125.750000   
    12778              36.549999              37.650002             144.429993   
    ...                      ...                    ...                    ...   
    3783               25.379999              50.599998             132.449997   
    1879               18.969999              27.920000             115.849998   
    6341               62.049999              47.380001              68.300003   
    5961               62.049999              47.380001              68.300003   
    11891              36.549999              37.650002             144.429993   

           sunshine_duration_march  ndvi_min_max_ratio_182_365  \
    992                 178.679993                    0.068182   
    9114                127.750000                    0.573333   
    6448                 75.199997                    0.175000   
    11990                89.730003                   -0.062500   
    12778               122.669998                    0.206897   
    ...                        ...                         ...   
    3783                108.970001                    0.216867   
    1879                127.750000                    0.569767   
    6341                178.679993                   -0.062500   
    5961                178.679993                    0.525000   
    11891               122.669998                    0.593750   

           relative_precipitation_01_90  ndvi_trend_sum_196_332  ndvi_sum_278_046  \
    992                        2.408889                 -0.0003              85.0   
    9114                       1.474444                  0.0005              57.0   
    6448                       2.066667                  0.0082              63.0   
    11990                      1.500000                 -0.0057              25.0   
    12778                      1.253333                 -0.0055              26.0   
    ...                             ...                     ...               ...   
    3783                       2.055556                  0.0048              77.0   
    1879                       1.474444                  0.0004              73.0   
    6341                       2.408889                 -0.0036              76.0   
    5961                       2.408889                 -0.0023              69.0   
    11891                      1.253333                 -0.0060              54.0   

           ndvi_min_182_365_rank  ndvi_mean_182_365_rank  ndvi_max_182_365_rank  \
    992                  13603.0                  5330.0                  719.0   
    9114                   642.0                  3805.0                 8718.0   
    6448                 11070.0                 12320.0                 5803.0   
    11990                14165.0                 13318.0                11874.0   
    12778                12135.0                 11526.0                12715.0   
    ...                      ...                     ...                    ...   
    3783                  8418.0                  7832.0                 3587.0   
    1879                   291.0                    86.0                 1514.0   
    6341                 14193.0                  9163.0                 5803.0   
    5961                   711.0                  1589.0                 5803.0   
    11891                 1108.0                  5330.0                11874.0   

           mean_temp_july  mean_temp_aug  mean_temp_sep  mean_temp_oct  \
    992            16.805         17.905         12.595         10.170   
    9114           17.135         16.160         12.165         10.780   
    6448           18.875         17.855         13.835          9.745   
    11990          20.755         20.585         15.870         10.090   
    12778          18.215         18.050         13.070         10.555   
    ...               ...            ...            ...            ...   
    3783           18.750         18.500         13.610          9.445   
    1879           17.135         16.160         12.165         10.780   
    6341           16.805         17.905         12.595         10.170   
    5961           16.805         17.905         12.595         10.170   
    11891          18.215         18.050         13.070         10.555   

           mean_temp_nov  mean_temp_dec  mean_temp_jan  mean_temp_feb  \
    992            4.015          2.625          2.545          4.420   
    9114           4.515          2.620          3.145         -3.685   
    6448           4.505          4.080          0.840          4.175   
    11990          4.465          3.510          0.390          3.600   
    12778          4.695          2.145          2.315         -2.635   
    ...              ...            ...            ...            ...   
    3783           4.315          3.440          0.025          3.465   
    1879           4.515          2.620          3.145         -3.685   
    6341           4.015          2.625          2.545          4.420   
    5961           4.015          2.625          2.545          4.420   
    11891          4.695          2.145          2.315         -2.635   

           mean_temp_march  min_temp_182_365  min_temp_01_90  max_temp_182_365  \
    992              3.960          5.093333       -0.833333         16.278333   
    9114             1.840          5.885000       -3.933333         15.240000   
    6448             5.950          5.720000       -0.340000         17.245000   
    11990            5.990          6.716667       -1.196667         18.375000   
    12778            0.705          6.485000       -4.256667         15.758334   
    ...                ...               ...             ...               ...   
    3783             5.505          4.960000       -1.843333         17.726667   
    1879             1.840          5.885000       -3.933333         15.240000   
    6341             3.960          5.093333       -0.833333         16.278333   
    5961             3.960          5.093333       -0.833333         16.278333   
    11891            0.705          6.485000       -4.256667         15.758334   

           max_temp_01_90  av_relative_humidity_01_90  av_precipitation_01_90  \
    992          8.116667                   79.636668               72.266665   
    9114         4.800000                   83.656667               44.233334   
    6448         7.650000                   82.459999               61.999999   
    11990        7.850000                   78.516668               45.000000   
    12778        4.513333                   81.153333               37.600001   
    ...               ...                         ...                     ...   
    3783         7.840000                   79.836667               61.666667   
    1879         4.800000                   83.656667               44.233334   
    6341         8.116667                   79.636668               72.266665   
    5961         8.116667                   79.636668               72.266665   
    11891        4.513333                   81.153333               37.600001   

           av_soil_temp_182_365  av_soil_temp_01_90  av_soil_temp_sum_182_365  \
    992               12.914079            4.461100                 77.484472   
    9114              12.328825            2.172681                 73.972950   
    6448              13.887283            4.111559                 83.323700   
    11990             14.988579            3.192542                 89.931475   
    12778             13.479815            0.991793                 80.878888   
    ...                     ...                 ...                       ...   
    3783              13.939227            3.871421                 83.635364   
    1879              12.328825            2.172681                 73.972950   
    6341              12.914079            4.461100                 77.484472   
    5961              12.914079            4.461100                 77.484472   
    11891             13.479815            0.991793                 80.878888   

           av_soil_temp_sum_01_90  sunshine_duration_sum_182_365  \
    992                 13.383300                     800.929997   
    9114                 6.518044                     610.989996   
    6448                12.334678                     958.939985   
    11990                9.577626                    1099.549980   
    12778                2.975379                     782.700005   
    ...                       ...                            ...   
    3783                11.614262                    1022.079996   
    1879                 6.518044                     610.989996   
    6341                13.383300                     800.929997   
    5961                13.383300                     800.929997   
    11891                2.975379                     782.700005   

           sunshine_duration_sum_01_90  av_sunshine_duration_182_365  \
    992                     294.359997                    133.488333   
    9114                    271.519999                    101.831666   
    6448                    237.979996                    159.823331   
    11990                   273.590004                    183.258330   
    12778                   304.749992                    130.450001   
    ...                            ...                           ...   
    3783                    292.019997                    170.346666   
    1879                    271.519999                    101.831666   
    6341                    294.359997                    133.488333   
    5961                    294.359997                    133.488333   
    11891                   304.749992                    130.450001   

           av_sunshine_duration_01_90  min_max_temp_ratio_182_365  \
    992                     98.119999                    0.312890   
    9114                    90.506666                    0.386155   
    6448                    79.326665                    0.331690   
    11990                   91.196668                    0.365533   
    12778                  101.583331                    0.411528   
    ...                           ...                         ...   
    3783                    97.339999                    0.279804   
    1879                    90.506666                    0.386155   
    6341                    98.119999                    0.312890   
    5961                    98.119999                    0.312890   
    11891                  101.583331                    0.411528   

           mean_temp_182_365  mean_temp_01_90  \
    992            10.685833         3.641667   
    9114           10.562500         0.433333   
    6448           11.482500         3.655000   
    11990          12.545833         3.326667   
    12778          11.121667         0.128333   
    ...                  ...              ...   
    3783           11.343333         2.998333   
    1879           10.562500         0.433333   
    6341           10.685833         3.641667   
    5961           10.685833         3.641667   
    11891          11.121667         0.128333   

           mean_temp_to_av_precipitation_ratio_01_90  \
    992                                     0.114645   
    9114                                    0.001658   
    6448                                    0.112876   
    11990                                   0.133037   
    12778                                  -0.002261   
    ...                                          ...   
    3783                                    0.086351   
    1879                                    0.001658   
    6341                                    0.114645   
    5961                                    0.114645   
    11891                                  -0.002261   

           av_soil_temp_to_av_precipitation_ratio_01_90  \
    992                                        0.061731   
    9114                                       0.049119   
    6448                                       0.066315   
    11990                                      0.070945   
    12778                                      0.026377   
    ...                                             ...   
    3783                                       0.062780   
    1879                                       0.049119   
    6341                                       0.061731   
    5961                                       0.061731   
    11891                                      0.026377   

           sunshine_dur_to_av_precipitation_ratio_01_90 av_relative_humidity_july  \
    992                                        1.357749                   Missing   
    9114                                       2.046119                     77-81   
    6448                                       1.279462                     63-77   
    11990                                      2.026593                     59-63   
    12778                                      2.701684                     77-81   
    ...                                             ...                       ...   
    3783                                       1.578486                     58-59   
    1879                                       2.046119                     77-81   
    6341                                       1.357749                   Missing   
    5961                                       1.357749                   Missing   
    11891                                      2.701684                     77-81   

          av_relative_humidity_sep av_relative_humidity_oct precipitation_sep  \
    992                      76-83                    62-69           Missing   
    9114                     62-69                    62-69             30-50   
    6448                   Missing                    62-69             30-50   
    11990                    62-69                    62-69             10-30   
    12778                    62-69                    62-69             30-50   
    ...                        ...                      ...               ...   
    3783                     62-69                    62-69             10-30   
    1879                     62-69                    62-69             30-50   
    6341                     76-83                    62-69           Missing   
    5961                     76-83                    62-69           Missing   
    11891                    62-69                    62-69             30-50   

          relative_precipitation_182_365 av_relative_humidity_182_365  \
    992                          Missing                      Missing   
    9114                             2-3                        81-87   
    6448                             1-2                      Missing   
    11990                            0-1                        71-76   
    12778                            2-3                        81-87   
    ...                              ...                          ...   
    3783                             1-2                        71-76   
    1879                             2-3                        81-87   
    6341                         Missing                      Missing   
    5961                         Missing                      Missing   
    11891                            2-3                        81-87   

          av_precipitation_182_365 mean_temp_to_av_precipitation_ratio_182_365  \
    992                    Missing                                     Missing   
    9114                      high                                         low   
    6448                       low                                         mid   
    11990                      low                                    0.1-0.22   
    12778                     high                                         low   
    ...                        ...                                         ...   
    3783                       low                                         mid   
    1879                      high                                         low   
    6341                   Missing                                     Missing   
    5961                   Missing                                     Missing   
    11891                     high                                         low   

          av_soil_temp_to_av_precipitation_ratio_182_365  \
    992                                          Missing   
    9114                                             low   
    6448                                             mid   
    11990                                           high   
    12778                                            low   
    ...                                              ...   
    3783                                             mid   
    1879                                             low   
    6341                                         Missing   
    5961                                         Missing   
    11891                                            low   

          sunshine_dur_to_av_precipitation_ratio_182_365  class  
    992                                          Missing      1  
    9114                                           0-0.3      1  
    6448                                           0-0.3      1  
    11990                                          0-0.3      0  
    12778                                          0-0.3      0  
    ...                                              ...    ...  
    3783                                           0-0.3      1  
    1879                                           0-0.3      0  
    6341                                         Missing      1  
    5961                                         Missing      0  
    11891                                          0-0.3      0  

    [14390 rows x 117 columns]

    # check test_df variables type
    d = test_df.dtypes.to_dict()

    from pprint import pprint
    pprint(d)

    {'area': dtype('int64'),
     'av_precipitation_01_90': dtype('float64'),
     'av_precipitation_182_365': dtype('O'),
     'av_relative_humidity_01_90': dtype('float64'),
     'av_relative_humidity_182_365': dtype('O'),
     'av_relative_humidity_aug': dtype('float64'),
     'av_relative_humidity_dec': dtype('float64'),
     'av_relative_humidity_feb': dtype('float64'),
     'av_relative_humidity_jan': dtype('float64'),
     'av_relative_humidity_july': dtype('O'),
     'av_relative_humidity_march': dtype('float64'),
     'av_relative_humidity_nov': dtype('float64'),
     'av_relative_humidity_oct': dtype('O'),
     'av_relative_humidity_sep': dtype('O'),
     'av_soil_temp_01_90': dtype('float64'),
     'av_soil_temp_182_365': dtype('float64'),
     'av_soil_temp_aug': dtype('float64'),
     'av_soil_temp_dec': dtype('float64'),
     'av_soil_temp_feb': dtype('float64'),
     'av_soil_temp_jan': dtype('float64'),
     'av_soil_temp_july': dtype('float64'),
     'av_soil_temp_march': dtype('float64'),
     'av_soil_temp_nov': dtype('float64'),
     'av_soil_temp_oct': dtype('float64'),
     'av_soil_temp_sep': dtype('float64'),
     'av_soil_temp_sum_01_90': dtype('float64'),
     'av_soil_temp_sum_182_365': dtype('float64'),
     'av_soil_temp_to_av_precipitation_ratio_01_90': dtype('float64'),
     'av_soil_temp_to_av_precipitation_ratio_182_365': dtype('O'),
     'av_sunshine_duration_01_90': dtype('float64'),
     'av_sunshine_duration_182_365': dtype('float64'),
     'class': dtype('int64'),
     'doy_changepoint_001_120': dtype('float64'),
     'doy_changepoint_182_365': dtype('float64'),
     'doy_first_level_shift_001_120': dtype('float64'),
     'doy_first_level_shift_182_365': dtype('float64'),
     'doy_ndvi_max_182_365': dtype('float64'),
     'doy_ndvi_min_182_365': dtype('float64'),
     'max_temp_01_90': dtype('float64'),
     'max_temp_182_365': dtype('float64'),
     'max_temp_aug': dtype('float64'),
     'max_temp_dec': dtype('float64'),
     'max_temp_feb': dtype('float64'),
     'max_temp_jan': dtype('float64'),
     'max_temp_july': dtype('float64'),
     'max_temp_march': dtype('float64'),
     'max_temp_nov': dtype('float64'),
     'max_temp_oct': dtype('float64'),
     'max_temp_sep': dtype('float64'),
     'mean_temp_01_90': dtype('float64'),
     'mean_temp_182_365': dtype('float64'),
     'mean_temp_aug': dtype('float64'),
     'mean_temp_dec': dtype('float64'),
     'mean_temp_feb': dtype('float64'),
     'mean_temp_jan': dtype('float64'),
     'mean_temp_july': dtype('float64'),
     'mean_temp_march': dtype('float64'),
     'mean_temp_nov': dtype('float64'),
     'mean_temp_oct': dtype('float64'),
     'mean_temp_sep': dtype('float64'),
     'mean_temp_to_av_precipitation_ratio_01_90': dtype('float64'),
     'mean_temp_to_av_precipitation_ratio_182_365': dtype('O'),
     'min_max_temp_ratio_182_365': dtype('float64'),
     'min_temp_01_90': dtype('float64'),
     'min_temp_182_365': dtype('float64'),
     'min_temp_aug': dtype('float64'),
     'min_temp_dec': dtype('float64'),
     'min_temp_feb': dtype('float64'),
     'min_temp_jan': dtype('float64'),
     'min_temp_july': dtype('float64'),
     'min_temp_march': dtype('float64'),
     'min_temp_nov': dtype('float64'),
     'min_temp_oct': dtype('float64'),
     'min_temp_sep': dtype('float64'),
     'ndvi_max_182_365': dtype('float64'),
     'ndvi_max_182_365_rank': dtype('float64'),
     'ndvi_mean_182_365': dtype('float64'),
     'ndvi_mean_182_365_rank': dtype('float64'),
     'ndvi_mean_var_182_365': dtype('float64'),
     'ndvi_min_182_365': dtype('float64'),
     'ndvi_min_182_365_rank': dtype('float64'),
     'ndvi_min_max_ratio_182_365': dtype('float64'),
     'ndvi_sum_001_046': dtype('float64'),
     'ndvi_sum_232_272': dtype('float64'),
     'ndvi_sum_278_046': dtype('float64'),
     'ndvi_sum_278_348': dtype('float64'),
     'ndvi_trend_196_273': dtype('float64'),
     'ndvi_trend_213_258': dtype('float64'),
     'ndvi_trend_274_332': dtype('float64'),
     'ndvi_trend_sum_196_332': dtype('float64'),
     'number_level_shifts_182_365': dtype('float64'),
     'precipitation_aug': dtype('float64'),
     'precipitation_dec': dtype('float64'),
     'precipitation_feb': dtype('float64'),
     'precipitation_jan': dtype('float64'),
     'precipitation_july': dtype('float64'),
     'precipitation_march': dtype('float64'),
     'precipitation_nov': dtype('float64'),
     'precipitation_oct': dtype('float64'),
     'precipitation_sep': dtype('O'),
     'relative_precipitation_01_90': dtype('float64'),
     'relative_precipitation_182_365': dtype('O'),
     'rpearson_ts_sim_182_365': dtype('float64'),
     'rpearson_ts_sim_1_120': dtype('float64'),
     'sunshine_dur_to_av_precipitation_ratio_01_90': dtype('float64'),
     'sunshine_dur_to_av_precipitation_ratio_182_365': dtype('O'),
     'sunshine_duration_aug': dtype('float64'),
     'sunshine_duration_dec': dtype('float64'),
     'sunshine_duration_feb': dtype('float64'),
     'sunshine_duration_jan': dtype('float64'),
     'sunshine_duration_july': dtype('float64'),
     'sunshine_duration_march': dtype('float64'),
     'sunshine_duration_nov': dtype('float64'),
     'sunshine_duration_oct': dtype('float64'),
     'sunshine_duration_sep': dtype('float64'),
     'sunshine_duration_sum_01_90': dtype('float64'),
     'sunshine_duration_sum_182_365': dtype('float64')}

    #perform one-hot coding for the object variables and drop the original variables 
    label= pd.get_dummies(test_df[['area','av_precipitation_182_365','av_relative_humidity_182_365','av_relative_humidity_july',
                                 'av_relative_humidity_oct','av_relative_humidity_sep','av_soil_temp_to_av_precipitation_ratio_182_365',
                                 'mean_temp_to_av_precipitation_ratio_182_365','precipitation_sep','relative_precipitation_182_365',
                                 'sunshine_dur_to_av_precipitation_ratio_182_365']])
    test_df= pd.concat([test_df,label], axis=1)
    test_df

           area  ndvi_min_182_365  ndvi_max_182_365  ndvi_mean_182_365  \
    992       2              0.06              0.88               0.53   
    9114      2              0.43              0.75               0.56   
    6448      1              0.14              0.80               0.35   
    11990     0             -0.04              0.64               0.30   
    12778     0              0.12              0.58               0.38   
    ...     ...               ...               ...                ...   
    3783      2              0.18              0.83               0.48   
    1879      2              0.49              0.86               0.74   
    6341      2             -0.05              0.80               0.45   
    5961      2              0.42              0.80               0.62   
    11891     0              0.38              0.64               0.53   

           ndvi_mean_var_182_365  ndvi_trend_196_273  ndvi_trend_213_258  \
    992                   0.0537              0.0000              0.0034   
    9114                  0.0090              0.0034              0.0033   
    6448                  0.0508             -0.0001              0.0001   
    11990                 0.0297             -0.0065             -0.0051   
    12778                 0.0247             -0.0001             -0.0020   
    ...                      ...                 ...                 ...   
    3783                  0.0732              0.0010              0.0022   
    1879                  0.0048              0.0000              0.0000   
    6341                  0.0666              0.0013              0.0086   
    5961                  0.0058             -0.0010              0.0008   
    11891                 0.0057             -0.0017              0.0001   

           ndvi_trend_274_332  ndvi_sum_232_272  ndvi_sum_278_348  \
    992               -0.0003              13.0              54.0   
    9114              -0.0029              28.0              36.0   
    6448               0.0083               6.0              35.0   
    11990              0.0008              11.0              12.0   
    12778             -0.0054              21.0              17.0   
    ...                   ...               ...               ...   
    3783               0.0038              10.0              52.0   
    1879               0.0004              30.0              54.0   
    6341              -0.0049              13.0              44.0   
    5961              -0.0013              24.0              43.0   
    11891             -0.0043              22.0              33.0   

           ndvi_sum_001_046  doy_ndvi_max_182_365  doy_ndvi_min_182_365  \
    992                31.0                 288.0                 273.0   
    9114               21.0                 268.0                 323.0   
    6448               28.0                 320.0                 200.0   
    11990              13.0                 182.0                 297.0   
    12778               9.0                 262.0                 334.0   
    ...                 ...                   ...                   ...   
    3783               25.0                 338.0                 230.0   
    1879               19.0                 288.0                 303.0   
    6341               32.0                 288.0                 323.0   
    5961               26.0                 236.0                 336.0   
    11891              21.0                 182.0                 324.0   

           rpearson_ts_sim_182_365  rpearson_ts_sim_1_120  \
    992                       0.86                   0.86   
    9114                     -0.37                  -0.62   
    6448                      0.75                   0.95   
    11990                    -0.82                  -0.74   
    12778                    -0.87                   0.49   
    ...                        ...                    ...   
    3783                      0.92                   0.92   
    1879                     -0.05                   0.85   
    6341                      0.70                   0.85   
    5961                     -0.31                  -0.80   
    11891                    -0.87                   0.88   

           doy_first_level_shift_182_365  number_level_shifts_182_365  \
    992                            280.0                          1.0   
    9114                           270.0                          3.0   
    6448                             0.0                          0.0   
    11990                          291.0                          2.0   
    12778                            0.0                          0.0   
    ...                              ...                          ...   
    3783                             0.0                          0.0   
    1879                           290.0                          2.0   
    6341                           330.0                          1.0   
    5961                             0.0                          0.0   
    11891                          214.0                          3.0   

           doy_first_level_shift_001_120  doy_changepoint_182_365  \
    992                              0.0                    276.0   
    9114                            58.0                    287.0   
    6448                             0.0                    283.0   
    11990                           79.0                    231.0   
    12778                          109.0                    296.0   
    ...                              ...                      ...   
    3783                            80.0                    284.0   
    1879                             0.0                    346.0   
    6341                            80.0                    260.0   
    5961                            83.0                    239.0   
    11891                           34.0                    292.0   

           doy_changepoint_001_120  min_temp_july  min_temp_aug  min_temp_sep  \
    992                       87.0           9.82         10.30          5.59   
    9114                      82.0          11.23          9.84          6.60   
    6448                      40.0          10.95         10.33          6.70   
    11990                     91.0          13.07         13.17          8.77   
    12778                     51.0          12.67         12.07          7.63   
    ...                        ...            ...           ...           ...   
    3783                      34.0           9.95         10.23          5.54   
    1879                      33.0          11.23          9.84          6.60   
    6341                      83.0           9.82         10.30          5.59   
    5961                      80.0           9.82         10.30          5.59   
    11891                     37.0          12.67         12.07          7.63   

           min_temp_oct  min_temp_nov  min_temp_dec  min_temp_jan  min_temp_feb  \
    992            5.36          0.44         -0.95         -0.82          0.57   
    9114           6.45          1.22         -0.03          0.18         -8.64   
    6448           3.64          0.98          1.72         -1.98         -0.89   
    11990          3.93          0.70          0.66         -2.61         -1.84   
    12778          6.52          1.09         -1.07         -0.79         -7.69   
    ...             ...           ...           ...           ...           ...   
    3783           3.01          0.43          0.60         -3.26         -2.52   
    1879           6.45          1.22         -0.03          0.18         -8.64   
    6341           5.36          0.44         -0.95         -0.82          0.57   
    5961           5.36          0.44         -0.95         -0.82          0.57   
    11891          6.52          1.09         -1.07         -0.79         -7.69   

           min_temp_march  max_temp_july  max_temp_aug  max_temp_sep  \
    992             -2.25      23.790001     25.510000     19.600000   
    9114            -3.34      23.040001     22.480000     17.730000   
    6448             1.85      26.799999     25.379999     20.969999   
    11990            0.86      28.440001     28.000000     22.969999   
    12778           -4.29      23.760000     24.030001     18.510000   
    ...               ...            ...           ...           ...   
    3783             0.25      27.549999     26.770000     21.680000   
    1879            -3.34      23.040001     22.480000     17.730000   
    6341            -2.25      23.790001     25.510000     19.600000   
    5961            -2.25      23.790001     25.510000     19.600000   
    11891           -4.29      23.760000     24.030001     18.510000   

           max_temp_oct  max_temp_nov  max_temp_dec  max_temp_jan  max_temp_feb  \
    992           14.98          7.59          6.20          5.91          8.27   
    9114          15.11          7.81          5.27          6.11          1.27   
    6448          15.85          8.03          6.44          3.66          9.24   
    11990         16.25          8.23          6.36          3.39          9.04   
    12778         14.59          8.30          5.36          5.42          2.42   
    ...             ...           ...           ...           ...           ...   
    3783          15.88          8.20          6.28          3.31          9.45   
    1879          15.11          7.81          5.27          6.11          1.27   
    6341          14.98          7.59          6.20          5.91          8.27   
    5961          14.98          7.59          6.20          5.91          8.27   
    11891         14.59          8.30          5.36          5.42          2.42   

           max_temp_march  av_relative_humidity_aug  av_relative_humidity_nov  \
    992             10.17                 69.599998                 90.489998   
    9114             7.02                 79.949997                 90.760002   
    6448            10.05                 67.370003                 88.510002   
    11990           11.12                 58.320000                 85.040001   
    12778            5.70                 76.620003                 92.180000   
    ...               ...                       ...                       ...   
    3783            10.76                 61.139999                 86.820000   
    1879             7.02                 79.949997                 90.760002   
    6341            10.17                 69.599998                 90.489998   
    5961            10.17                 69.599998                 90.489998   
    11891            5.70                 76.620003                 92.180000   

           av_relative_humidity_dec  av_relative_humidity_jan  \
    992                   86.669998                 88.330002   
    9114                  89.169998                 89.089996   
    6448                  91.379997                 87.769997   
    11990                 88.300003                 86.120003   
    12778                 90.139999                 88.809998   
    ...                         ...                       ...   
    3783                  87.019997                 85.930000   
    1879                  89.169998                 89.089996   
    6341                  86.669998                 88.330002   
    5961                  86.669998                 88.330002   
    11891                 90.139999                 88.809998   

           av_relative_humidity_feb  av_relative_humidity_march  \
    992                   79.290001                   71.290001   
    9114                  81.730003                   80.150002   
    6448                  79.050003                   80.559998   
    11990                 72.540001                   76.889999   
    12778                 77.220001                   77.430000   
    ...                         ...                         ...   
    3783                  76.599998                   76.980003   
    1879                  81.730003                   80.150002   
    6341                  79.290001                   71.290001   
    5961                  79.290001                   71.290001   
    11891                 77.220001                   77.430000   

           precipitation_july  precipitation_aug  precipitation_oct  \
    992             69.099998          36.500000          72.199997   
    9114           158.199997          91.000000          54.099998   
    6448            41.700001          27.799999          40.099998   
    11990           51.900002          10.100000          12.500000   
    12778          144.300003          73.800003          74.599998   
    ...                   ...                ...                ...   
    3783            28.100000          21.100000          23.700001   
    1879           158.199997          91.000000          54.099998   
    6341            69.099998          36.500000          72.199997   
    5961            69.099998          36.500000          72.199997   
    11891          144.300003          73.800003          74.599998   

           precipitation_nov  precipitation_dec  precipitation_jan  \
    992            36.400002          76.500000          39.599998   
    9114           79.300003          49.200001          84.900002   
    6448           13.100000         104.599998          83.500000   
    11990          15.400000          38.000000          51.599998   
    12778          62.299999          35.099998          58.400002   
    ...                  ...                ...                ...   
    3783           26.000000          96.599998          90.000000   
    1879           79.300003          49.200001          84.900002   
    6341           36.400002          76.500000          39.599998   
    5961           36.400002          76.500000          39.599998   
    11891          62.299999          35.099998          58.400002   

           precipitation_feb  precipitation_march  av_soil_temp_july  \
    992           125.099998            52.099998          20.346640   
    9114           10.400000            37.400002          18.932528   
    6448           23.799999            78.699997          23.153091   
    11990          23.500000            59.900002          26.486828   
    12778           1.900000            52.500000          22.654167   
    ...                  ...                  ...                ...   
    3783           18.600000            76.400002          22.870296   
    1879           10.400000            37.400002          18.932528   
    6341          125.099998            52.099998          20.346640   
    5961          125.099998            52.099998          20.346640   
    11891           1.900000            52.500000          22.654167   

           av_soil_temp_aug  av_soil_temp_sep  av_soil_temp_oct  av_soil_temp_nov  \
    992           20.362904         15.681666         11.508737          5.924445   
    9114          18.329033         14.912084         11.951210          6.453472   
    6448          22.164381         16.522223         11.106989          5.841667   
    11990         25.511156         18.827917         10.582796          5.031111   
    12778         22.565994         15.948750         11.510080          5.809306   
    ...                 ...               ...               ...               ...   
    3783          22.411291         16.557917         11.350403          6.155000   
    1879          18.329033         14.912084         11.951210          6.453472   
    6341          20.362904         15.681666         11.508737          5.924445   
    5961          20.362904         15.681666         11.508737          5.924445   
    11891         22.565994         15.948750         11.510080          5.809306   

           av_soil_temp_dec  ...  sunshine_duration_sum_182_365  \
    992            3.660081  ...                     800.929997   
    9114           3.394624  ...                     610.989996   
    6448           4.535349  ...                     958.939985   
    11990          3.491667  ...                    1099.549980   
    12778          2.390591  ...                     782.700005   
    ...                 ...  ...                            ...   
    3783           4.290457  ...                    1022.079996   
    1879           3.394624  ...                     610.989996   
    6341           3.660081  ...                     800.929997   
    5961           3.660081  ...                     800.929997   
    11891          2.390591  ...                     782.700005   

           sunshine_duration_sum_01_90  av_sunshine_duration_182_365  \
    992                     294.359997                    133.488333   
    9114                    271.519999                    101.831666   
    6448                    237.979996                    159.823331   
    11990                   273.590004                    183.258330   
    12778                   304.749992                    130.450001   
    ...                            ...                           ...   
    3783                    292.019997                    170.346666   
    1879                    271.519999                    101.831666   
    6341                    294.359997                    133.488333   
    5961                    294.359997                    133.488333   
    11891                   304.749992                    130.450001   

           av_sunshine_duration_01_90  min_max_temp_ratio_182_365  \
    992                     98.119999                    0.312890   
    9114                    90.506666                    0.386155   
    6448                    79.326665                    0.331690   
    11990                   91.196668                    0.365533   
    12778                  101.583331                    0.411528   
    ...                           ...                         ...   
    3783                    97.339999                    0.279804   
    1879                    90.506666                    0.386155   
    6341                    98.119999                    0.312890   
    5961                    98.119999                    0.312890   
    11891                  101.583331                    0.411528   

           mean_temp_182_365  mean_temp_01_90  \
    992            10.685833         3.641667   
    9114           10.562500         0.433333   
    6448           11.482500         3.655000   
    11990          12.545833         3.326667   
    12778          11.121667         0.128333   
    ...                  ...              ...   
    3783           11.343333         2.998333   
    1879           10.562500         0.433333   
    6341           10.685833         3.641667   
    5961           10.685833         3.641667   
    11891          11.121667         0.128333   

           mean_temp_to_av_precipitation_ratio_01_90  \
    992                                     0.114645   
    9114                                    0.001658   
    6448                                    0.112876   
    11990                                   0.133037   
    12778                                  -0.002261   
    ...                                          ...   
    3783                                    0.086351   
    1879                                    0.001658   
    6341                                    0.114645   
    5961                                    0.114645   
    11891                                  -0.002261   

           av_soil_temp_to_av_precipitation_ratio_01_90  \
    992                                        0.061731   
    9114                                       0.049119   
    6448                                       0.066315   
    11990                                      0.070945   
    12778                                      0.026377   
    ...                                             ...   
    3783                                       0.062780   
    1879                                       0.049119   
    6341                                       0.061731   
    5961                                       0.061731   
    11891                                      0.026377   

           sunshine_dur_to_av_precipitation_ratio_01_90  \
    992                                        1.357749   
    9114                                       2.046119   
    6448                                       1.279462   
    11990                                      2.026593   
    12778                                      2.701684   
    ...                                             ...   
    3783                                       1.578486   
    1879                                       2.046119   
    6341                                       1.357749   
    5961                                       1.357749   
    11891                                      2.701684   

           av_relative_humidity_july  av_relative_humidity_sep  \
    992                      Missing                     76-83   
    9114                       77-81                     62-69   
    6448                       63-77                   Missing   
    11990                      59-63                     62-69   
    12778                      77-81                     62-69   
    ...                          ...                       ...   
    3783                       58-59                     62-69   
    1879                       77-81                     62-69   
    6341                     Missing                     76-83   
    5961                     Missing                     76-83   
    11891                      77-81                     62-69   

           av_relative_humidity_oct  precipitation_sep  \
    992                       62-69            Missing   
    9114                      62-69              30-50   
    6448                      62-69              30-50   
    11990                     62-69              10-30   
    12778                     62-69              30-50   
    ...                         ...                ...   
    3783                      62-69              10-30   
    1879                      62-69              30-50   
    6341                      62-69            Missing   
    5961                      62-69            Missing   
    11891                     62-69              30-50   

           relative_precipitation_182_365  av_relative_humidity_182_365  \
    992                           Missing                       Missing   
    9114                              2-3                         81-87   
    6448                              1-2                       Missing   
    11990                             0-1                         71-76   
    12778                             2-3                         81-87   
    ...                               ...                           ...   
    3783                              1-2                         71-76   
    1879                              2-3                         81-87   
    6341                          Missing                       Missing   
    5961                          Missing                       Missing   
    11891                             2-3                         81-87   

           av_precipitation_182_365  mean_temp_to_av_precipitation_ratio_182_365  \
    992                     Missing                                      Missing   
    9114                       high                                          low   
    6448                        low                                          mid   
    11990                       low                                     0.1-0.22   
    12778                      high                                          low   
    ...                         ...                                          ...   
    3783                        low                                          mid   
    1879                       high                                          low   
    6341                    Missing                                      Missing   
    5961                    Missing                                      Missing   
    11891                      high                                          low   

           av_soil_temp_to_av_precipitation_ratio_182_365  \
    992                                           Missing   
    9114                                              low   
    6448                                              mid   
    11990                                            high   
    12778                                             low   
    ...                                               ...   
    3783                                              mid   
    1879                                              low   
    6341                                          Missing   
    5961                                          Missing   
    11891                                             low   

           sunshine_dur_to_av_precipitation_ratio_182_365  class  area  \
    992                                           Missing      1     2   
    9114                                            0-0.3      1     2   
    6448                                            0-0.3      1     1   
    11990                                           0-0.3      0     0   
    12778                                           0-0.3      0     0   
    ...                                               ...    ...   ...   
    3783                                            0-0.3      1     2   
    1879                                            0-0.3      0     2   
    6341                                          Missing      1     2   
    5961                                          Missing      0     2   
    11891                                           0-0.3      0     0   

           av_precipitation_182_365_Missing  av_precipitation_182_365_high  \
    992                                   1                              0   
    9114                                  0                              1   
    6448                                  0                              0   
    11990                                 0                              0   
    12778                                 0                              1   
    ...                                 ...                            ...   
    3783                                  0                              0   
    1879                                  0                              1   
    6341                                  1                              0   
    5961                                  1                              0   
    11891                                 0                              1   

           av_precipitation_182_365_low  av_relative_humidity_182_365_71-76  \
    992                               0                                   0   
    9114                              0                                   0   
    6448                              1                                   0   
    11990                             1                                   1   
    12778                             0                                   0   
    ...                             ...                                 ...   
    3783                              1                                   1   
    1879                              0                                   0   
    6341                              0                                   0   
    5961                              0                                   0   
    11891                             0                                   0   

           av_relative_humidity_182_365_76-81  av_relative_humidity_182_365_81-87  \
    992                                     0                                   0   
    9114                                    0                                   1   
    6448                                    0                                   0   
    11990                                   0                                   0   
    12778                                   0                                   1   
    ...                                   ...                                 ...   
    3783                                    0                                   0   
    1879                                    0                                   1   
    6341                                    0                                   0   
    5961                                    0                                   0   
    11891                                   0                                   1   

           av_relative_humidity_182_365_Missing  av_relative_humidity_july_58-59  \
    992                                       1                                0   
    9114                                      0                                0   
    6448                                      1                                0   
    11990                                     0                                0   
    12778                                     0                                0   
    ...                                     ...                              ...   
    3783                                      0                                1   
    1879                                      0                                0   
    6341                                      1                                0   
    5961                                      1                                0   
    11891                                     0                                0   

           av_relative_humidity_july_59-63  av_relative_humidity_july_63-77  \
    992                                  0                                0   
    9114                                 0                                0   
    6448                                 0                                1   
    11990                                1                                0   
    12778                                0                                0   
    ...                                ...                              ...   
    3783                                 0                                0   
    1879                                 0                                0   
    6341                                 0                                0   
    5961                                 0                                0   
    11891                                0                                0   

           av_relative_humidity_july_77-81  av_relative_humidity_july_Missing  \
    992                                  0                                  1   
    9114                                 1                                  0   
    6448                                 0                                  0   
    11990                                0                                  0   
    12778                                1                                  0   
    ...                                ...                                ...   
    3783                                 0                                  0   
    1879                                 1                                  0   
    6341                                 0                                  1   
    5961                                 0                                  1   
    11891                                1                                  0   

           av_relative_humidity_oct_62-69  av_relative_humidity_sep_62-69  \
    992                                 1                               0   
    9114                                1                               1   
    6448                                1                               0   
    11990                               1                               1   
    12778                               1                               1   
    ...                               ...                             ...   
    3783                                1                               1   
    1879                                1                               1   
    6341                                1                               0   
    5961                                1                               0   
    11891                               1                               1   

           av_relative_humidity_sep_69-76  av_relative_humidity_sep_76-83  \
    992                                 0                               1   
    9114                                0                               0   
    6448                                0                               0   
    11990                               0                               0   
    12778                               0                               0   
    ...                               ...                             ...   
    3783                                0                               0   
    1879                                0                               0   
    6341                                0                               1   
    5961                                0                               1   
    11891                               0                               0   

           av_relative_humidity_sep_Missing  \
    992                                   0   
    9114                                  0   
    6448                                  1   
    11990                                 0   
    12778                                 0   
    ...                                 ...   
    3783                                  0   
    1879                                  0   
    6341                                  0   
    5961                                  0   
    11891                                 0   

           av_soil_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1        
    9114                                                   0        
    6448                                                   0        
    11990                                                  0        
    12778                                                  0        
    ...                                                  ...        
    3783                                                   0        
    1879                                                   0        
    6341                                                   1        
    5961                                                   1        
    11891                                                  0        

           av_soil_temp_to_av_precipitation_ratio_182_365_high  \
    992                                                    0     
    9114                                                   0     
    6448                                                   0     
    11990                                                  1     
    12778                                                  0     
    ...                                                  ...     
    3783                                                   0     
    1879                                                   0     
    6341                                                   0     
    5961                                                   0     
    11891                                                  0     

           av_soil_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                    0    
    9114                                                   1    
    6448                                                   0    
    11990                                                  0    
    12778                                                  1    
    ...                                                  ...    
    3783                                                   0    
    1879                                                   1    
    6341                                                   0    
    5961                                                   0    
    11891                                                  1    

           av_soil_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                    0    
    9114                                                   0    
    6448                                                   1    
    11990                                                  0    
    12778                                                  0    
    ...                                                  ...    
    3783                                                   1    
    1879                                                   0    
    6341                                                   0    
    5961                                                   0    
    11891                                                  0    

           mean_temp_to_av_precipitation_ratio_182_365_0.1-0.22  \
    992                                                    0      
    9114                                                   0      
    6448                                                   0      
    11990                                                  1      
    12778                                                  0      
    ...                                                  ...      
    3783                                                   0      
    1879                                                   0      
    6341                                                   0      
    5961                                                   0      
    11891                                                  0      

           mean_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1     
    9114                                                   0     
    6448                                                   0     
    11990                                                  0     
    12778                                                  0     
    ...                                                  ...     
    3783                                                   0     
    1879                                                   0     
    6341                                                   1     
    5961                                                   1     
    11891                                                  0     

           mean_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                  0   
    9114                                                 1   
    6448                                                 0   
    11990                                                0   
    12778                                                1   
    ...                                                ...   
    3783                                                 0   
    1879                                                 1   
    6341                                                 0   
    5961                                                 0   
    11891                                                1   

           mean_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                  0   
    9114                                                 0   
    6448                                                 1   
    11990                                                0   
    12778                                                0   
    ...                                                ...   
    3783                                                 1   
    1879                                                 0   
    6341                                                 0   
    5961                                                 0   
    11891                                                0   

           precipitation_sep_10-30 precipitation_sep_30-50  \
    992                          0                       0   
    9114                         0                       1   
    6448                         0                       1   
    11990                        1                       0   
    12778                        0                       1   
    ...                        ...                     ...   
    3783                         1                       0   
    1879                         0                       1   
    6341                         0                       0   
    5961                         0                       0   
    11891                        0                       1   

          precipitation_sep_50-70 precipitation_sep_70-90  \
    992                         0                       0   
    9114                        0                       0   
    6448                        0                       0   
    11990                       0                       0   
    12778                       0                       0   
    ...                       ...                     ...   
    3783                        0                       0   
    1879                        0                       0   
    6341                        0                       0   
    5961                        0                       0   
    11891                       0                       0   

          precipitation_sep_Missing relative_precipitation_182_365_0-1  \
    992                           1                                  0   
    9114                          0                                  0   
    6448                          0                                  0   
    11990                         0                                  1   
    12778                         0                                  0   
    ...                         ...                                ...   
    3783                          0                                  0   
    1879                          0                                  0   
    6341                          1                                  0   
    5961                          1                                  0   
    11891                         0                                  0   

          relative_precipitation_182_365_1-2 relative_precipitation_182_365_2-3  \
    992                                    0                                  0   
    9114                                   0                                  1   
    6448                                   1                                  0   
    11990                                  0                                  0   
    12778                                  0                                  1   
    ...                                  ...                                ...   
    3783                                   1                                  0   
    1879                                   0                                  1   
    6341                                   0                                  0   
    5961                                   0                                  0   
    11891                                  0                                  1   

          relative_precipitation_182_365_Missing  \
    992                                        1   
    9114                                       0   
    6448                                       0   
    11990                                      0   
    12778                                      0   
    ...                                      ...   
    3783                                       0   
    1879                                       0   
    6341                                       1   
    5961                                       1   
    11891                                      0   

          sunshine_dur_to_av_precipitation_ratio_182_365_0-0.3  \
    992                                                    0     
    9114                                                   1     
    6448                                                   1     
    11990                                                  1     
    12778                                                  1     
    ...                                                  ...     
    3783                                                   1     
    1879                                                   1     
    6341                                                   0     
    5961                                                   0     
    11891                                                  1     

          sunshine_dur_to_av_precipitation_ratio_182_365_Missing  
    992                                                    1      
    9114                                                   0      
    6448                                                   0      
    11990                                                  0      
    12778                                                  0      
    ...                                                  ...      
    3783                                                   0      
    1879                                                   0      
    6341                                                   1      
    5961                                                   1      
    11891                                                  0      

    [14390 rows x 154 columns]

    #drop old labels
    test_df.drop(['area','av_precipitation_182_365','av_relative_humidity_182_365','av_relative_humidity_july',
                                 'av_relative_humidity_oct','av_relative_humidity_sep','av_soil_temp_to_av_precipitation_ratio_182_365',
                                 'mean_temp_to_av_precipitation_ratio_182_365','precipitation_sep','relative_precipitation_182_365',
                                 'sunshine_dur_to_av_precipitation_ratio_182_365'], axis=1, inplace=True)
    test_df

           ndvi_min_182_365  ndvi_max_182_365  ndvi_mean_182_365  \
    992                0.06              0.88               0.53   
    9114               0.43              0.75               0.56   
    6448               0.14              0.80               0.35   
    11990             -0.04              0.64               0.30   
    12778              0.12              0.58               0.38   
    ...                 ...               ...                ...   
    3783               0.18              0.83               0.48   
    1879               0.49              0.86               0.74   
    6341              -0.05              0.80               0.45   
    5961               0.42              0.80               0.62   
    11891              0.38              0.64               0.53   

           ndvi_mean_var_182_365  ndvi_trend_196_273  ndvi_trend_213_258  \
    992                   0.0537              0.0000              0.0034   
    9114                  0.0090              0.0034              0.0033   
    6448                  0.0508             -0.0001              0.0001   
    11990                 0.0297             -0.0065             -0.0051   
    12778                 0.0247             -0.0001             -0.0020   
    ...                      ...                 ...                 ...   
    3783                  0.0732              0.0010              0.0022   
    1879                  0.0048              0.0000              0.0000   
    6341                  0.0666              0.0013              0.0086   
    5961                  0.0058             -0.0010              0.0008   
    11891                 0.0057             -0.0017              0.0001   

           ndvi_trend_274_332  ndvi_sum_232_272  ndvi_sum_278_348  \
    992               -0.0003              13.0              54.0   
    9114              -0.0029              28.0              36.0   
    6448               0.0083               6.0              35.0   
    11990              0.0008              11.0              12.0   
    12778             -0.0054              21.0              17.0   
    ...                   ...               ...               ...   
    3783               0.0038              10.0              52.0   
    1879               0.0004              30.0              54.0   
    6341              -0.0049              13.0              44.0   
    5961              -0.0013              24.0              43.0   
    11891             -0.0043              22.0              33.0   

           ndvi_sum_001_046  doy_ndvi_max_182_365  doy_ndvi_min_182_365  \
    992                31.0                 288.0                 273.0   
    9114               21.0                 268.0                 323.0   
    6448               28.0                 320.0                 200.0   
    11990              13.0                 182.0                 297.0   
    12778               9.0                 262.0                 334.0   
    ...                 ...                   ...                   ...   
    3783               25.0                 338.0                 230.0   
    1879               19.0                 288.0                 303.0   
    6341               32.0                 288.0                 323.0   
    5961               26.0                 236.0                 336.0   
    11891              21.0                 182.0                 324.0   

           rpearson_ts_sim_182_365  rpearson_ts_sim_1_120  \
    992                       0.86                   0.86   
    9114                     -0.37                  -0.62   
    6448                      0.75                   0.95   
    11990                    -0.82                  -0.74   
    12778                    -0.87                   0.49   
    ...                        ...                    ...   
    3783                      0.92                   0.92   
    1879                     -0.05                   0.85   
    6341                      0.70                   0.85   
    5961                     -0.31                  -0.80   
    11891                    -0.87                   0.88   

           doy_first_level_shift_182_365  number_level_shifts_182_365  \
    992                            280.0                          1.0   
    9114                           270.0                          3.0   
    6448                             0.0                          0.0   
    11990                          291.0                          2.0   
    12778                            0.0                          0.0   
    ...                              ...                          ...   
    3783                             0.0                          0.0   
    1879                           290.0                          2.0   
    6341                           330.0                          1.0   
    5961                             0.0                          0.0   
    11891                          214.0                          3.0   

           doy_first_level_shift_001_120  doy_changepoint_182_365  \
    992                              0.0                    276.0   
    9114                            58.0                    287.0   
    6448                             0.0                    283.0   
    11990                           79.0                    231.0   
    12778                          109.0                    296.0   
    ...                              ...                      ...   
    3783                            80.0                    284.0   
    1879                             0.0                    346.0   
    6341                            80.0                    260.0   
    5961                            83.0                    239.0   
    11891                           34.0                    292.0   

           doy_changepoint_001_120  min_temp_july  min_temp_aug  min_temp_sep  \
    992                       87.0           9.82         10.30          5.59   
    9114                      82.0          11.23          9.84          6.60   
    6448                      40.0          10.95         10.33          6.70   
    11990                     91.0          13.07         13.17          8.77   
    12778                     51.0          12.67         12.07          7.63   
    ...                        ...            ...           ...           ...   
    3783                      34.0           9.95         10.23          5.54   
    1879                      33.0          11.23          9.84          6.60   
    6341                      83.0           9.82         10.30          5.59   
    5961                      80.0           9.82         10.30          5.59   
    11891                     37.0          12.67         12.07          7.63   

           min_temp_oct  min_temp_nov  min_temp_dec  min_temp_jan  min_temp_feb  \
    992            5.36          0.44         -0.95         -0.82          0.57   
    9114           6.45          1.22         -0.03          0.18         -8.64   
    6448           3.64          0.98          1.72         -1.98         -0.89   
    11990          3.93          0.70          0.66         -2.61         -1.84   
    12778          6.52          1.09         -1.07         -0.79         -7.69   
    ...             ...           ...           ...           ...           ...   
    3783           3.01          0.43          0.60         -3.26         -2.52   
    1879           6.45          1.22         -0.03          0.18         -8.64   
    6341           5.36          0.44         -0.95         -0.82          0.57   
    5961           5.36          0.44         -0.95         -0.82          0.57   
    11891          6.52          1.09         -1.07         -0.79         -7.69   

           min_temp_march  max_temp_july  max_temp_aug  max_temp_sep  \
    992             -2.25      23.790001     25.510000     19.600000   
    9114            -3.34      23.040001     22.480000     17.730000   
    6448             1.85      26.799999     25.379999     20.969999   
    11990            0.86      28.440001     28.000000     22.969999   
    12778           -4.29      23.760000     24.030001     18.510000   
    ...               ...            ...           ...           ...   
    3783             0.25      27.549999     26.770000     21.680000   
    1879            -3.34      23.040001     22.480000     17.730000   
    6341            -2.25      23.790001     25.510000     19.600000   
    5961            -2.25      23.790001     25.510000     19.600000   
    11891           -4.29      23.760000     24.030001     18.510000   

           max_temp_oct  max_temp_nov  max_temp_dec  max_temp_jan  max_temp_feb  \
    992           14.98          7.59          6.20          5.91          8.27   
    9114          15.11          7.81          5.27          6.11          1.27   
    6448          15.85          8.03          6.44          3.66          9.24   
    11990         16.25          8.23          6.36          3.39          9.04   
    12778         14.59          8.30          5.36          5.42          2.42   
    ...             ...           ...           ...           ...           ...   
    3783          15.88          8.20          6.28          3.31          9.45   
    1879          15.11          7.81          5.27          6.11          1.27   
    6341          14.98          7.59          6.20          5.91          8.27   
    5961          14.98          7.59          6.20          5.91          8.27   
    11891         14.59          8.30          5.36          5.42          2.42   

           max_temp_march  av_relative_humidity_aug  av_relative_humidity_nov  \
    992             10.17                 69.599998                 90.489998   
    9114             7.02                 79.949997                 90.760002   
    6448            10.05                 67.370003                 88.510002   
    11990           11.12                 58.320000                 85.040001   
    12778            5.70                 76.620003                 92.180000   
    ...               ...                       ...                       ...   
    3783            10.76                 61.139999                 86.820000   
    1879             7.02                 79.949997                 90.760002   
    6341            10.17                 69.599998                 90.489998   
    5961            10.17                 69.599998                 90.489998   
    11891            5.70                 76.620003                 92.180000   

           av_relative_humidity_dec  av_relative_humidity_jan  \
    992                   86.669998                 88.330002   
    9114                  89.169998                 89.089996   
    6448                  91.379997                 87.769997   
    11990                 88.300003                 86.120003   
    12778                 90.139999                 88.809998   
    ...                         ...                       ...   
    3783                  87.019997                 85.930000   
    1879                  89.169998                 89.089996   
    6341                  86.669998                 88.330002   
    5961                  86.669998                 88.330002   
    11891                 90.139999                 88.809998   

           av_relative_humidity_feb  av_relative_humidity_march  \
    992                   79.290001                   71.290001   
    9114                  81.730003                   80.150002   
    6448                  79.050003                   80.559998   
    11990                 72.540001                   76.889999   
    12778                 77.220001                   77.430000   
    ...                         ...                         ...   
    3783                  76.599998                   76.980003   
    1879                  81.730003                   80.150002   
    6341                  79.290001                   71.290001   
    5961                  79.290001                   71.290001   
    11891                 77.220001                   77.430000   

           precipitation_july  precipitation_aug  precipitation_oct  \
    992             69.099998          36.500000          72.199997   
    9114           158.199997          91.000000          54.099998   
    6448            41.700001          27.799999          40.099998   
    11990           51.900002          10.100000          12.500000   
    12778          144.300003          73.800003          74.599998   
    ...                   ...                ...                ...   
    3783            28.100000          21.100000          23.700001   
    1879           158.199997          91.000000          54.099998   
    6341            69.099998          36.500000          72.199997   
    5961            69.099998          36.500000          72.199997   
    11891          144.300003          73.800003          74.599998   

           precipitation_nov  precipitation_dec  precipitation_jan  \
    992            36.400002          76.500000          39.599998   
    9114           79.300003          49.200001          84.900002   
    6448           13.100000         104.599998          83.500000   
    11990          15.400000          38.000000          51.599998   
    12778          62.299999          35.099998          58.400002   
    ...                  ...                ...                ...   
    3783           26.000000          96.599998          90.000000   
    1879           79.300003          49.200001          84.900002   
    6341           36.400002          76.500000          39.599998   
    5961           36.400002          76.500000          39.599998   
    11891          62.299999          35.099998          58.400002   

           precipitation_feb  precipitation_march  av_soil_temp_july  \
    992           125.099998            52.099998          20.346640   
    9114           10.400000            37.400002          18.932528   
    6448           23.799999            78.699997          23.153091   
    11990          23.500000            59.900002          26.486828   
    12778           1.900000            52.500000          22.654167   
    ...                  ...                  ...                ...   
    3783           18.600000            76.400002          22.870296   
    1879           10.400000            37.400002          18.932528   
    6341          125.099998            52.099998          20.346640   
    5961          125.099998            52.099998          20.346640   
    11891           1.900000            52.500000          22.654167   

           av_soil_temp_aug  av_soil_temp_sep  av_soil_temp_oct  av_soil_temp_nov  \
    992           20.362904         15.681666         11.508737          5.924445   
    9114          18.329033         14.912084         11.951210          6.453472   
    6448          22.164381         16.522223         11.106989          5.841667   
    11990         25.511156         18.827917         10.582796          5.031111   
    12778         22.565994         15.948750         11.510080          5.809306   
    ...                 ...               ...               ...               ...   
    3783          22.411291         16.557917         11.350403          6.155000   
    1879          18.329033         14.912084         11.951210          6.453472   
    6341          20.362904         15.681666         11.508737          5.924445   
    5961          20.362904         15.681666         11.508737          5.924445   
    11891         22.565994         15.948750         11.510080          5.809306   

           av_soil_temp_dec  av_soil_temp_jan  ...  mean_temp_march  \
    992            3.660081          3.244758  ...            3.960   
    9114           3.394624          3.566263  ...            1.840   
    6448           4.535349          2.118414  ...            5.950   
    11990          3.491667          1.461156  ...            5.990   
    12778          2.390591          2.156720  ...            0.705   
    ...                 ...               ...  ...              ...   
    3783           4.290457          2.178495  ...            5.505   
    1879           3.394624          3.566263  ...            1.840   
    6341           3.660081          3.244758  ...            3.960   
    5961           3.660081          3.244758  ...            3.960   
    11891          2.390591          2.156720  ...            0.705   

           min_temp_182_365  min_temp_01_90  max_temp_182_365  max_temp_01_90  \
    992            5.093333       -0.833333         16.278333        8.116667   
    9114           5.885000       -3.933333         15.240000        4.800000   
    6448           5.720000       -0.340000         17.245000        7.650000   
    11990          6.716667       -1.196667         18.375000        7.850000   
    12778          6.485000       -4.256667         15.758334        4.513333   
    ...                 ...             ...               ...             ...   
    3783           4.960000       -1.843333         17.726667        7.840000   
    1879           5.885000       -3.933333         15.240000        4.800000   
    6341           5.093333       -0.833333         16.278333        8.116667   
    5961           5.093333       -0.833333         16.278333        8.116667   
    11891          6.485000       -4.256667         15.758334        4.513333   

           av_relative_humidity_01_90  av_precipitation_01_90  \
    992                     79.636668               72.266665   
    9114                    83.656667               44.233334   
    6448                    82.459999               61.999999   
    11990                   78.516668               45.000000   
    12778                   81.153333               37.600001   
    ...                           ...                     ...   
    3783                    79.836667               61.666667   
    1879                    83.656667               44.233334   
    6341                    79.636668               72.266665   
    5961                    79.636668               72.266665   
    11891                   81.153333               37.600001   

           av_soil_temp_182_365  av_soil_temp_01_90  av_soil_temp_sum_182_365  \
    992               12.914079            4.461100                 77.484472   
    9114              12.328825            2.172681                 73.972950   
    6448              13.887283            4.111559                 83.323700   
    11990             14.988579            3.192542                 89.931475   
    12778             13.479815            0.991793                 80.878888   
    ...                     ...                 ...                       ...   
    3783              13.939227            3.871421                 83.635364   
    1879              12.328825            2.172681                 73.972950   
    6341              12.914079            4.461100                 77.484472   
    5961              12.914079            4.461100                 77.484472   
    11891             13.479815            0.991793                 80.878888   

           av_soil_temp_sum_01_90  sunshine_duration_sum_182_365  \
    992                 13.383300                     800.929997   
    9114                 6.518044                     610.989996   
    6448                12.334678                     958.939985   
    11990                9.577626                    1099.549980   
    12778                2.975379                     782.700005   
    ...                       ...                            ...   
    3783                11.614262                    1022.079996   
    1879                 6.518044                     610.989996   
    6341                13.383300                     800.929997   
    5961                13.383300                     800.929997   
    11891                2.975379                     782.700005   

           sunshine_duration_sum_01_90  av_sunshine_duration_182_365  \
    992                     294.359997                    133.488333   
    9114                    271.519999                    101.831666   
    6448                    237.979996                    159.823331   
    11990                   273.590004                    183.258330   
    12778                   304.749992                    130.450001   
    ...                            ...                           ...   
    3783                    292.019997                    170.346666   
    1879                    271.519999                    101.831666   
    6341                    294.359997                    133.488333   
    5961                    294.359997                    133.488333   
    11891                   304.749992                    130.450001   

           av_sunshine_duration_01_90  min_max_temp_ratio_182_365  \
    992                     98.119999                    0.312890   
    9114                    90.506666                    0.386155   
    6448                    79.326665                    0.331690   
    11990                   91.196668                    0.365533   
    12778                  101.583331                    0.411528   
    ...                           ...                         ...   
    3783                    97.339999                    0.279804   
    1879                    90.506666                    0.386155   
    6341                    98.119999                    0.312890   
    5961                    98.119999                    0.312890   
    11891                  101.583331                    0.411528   

           mean_temp_182_365  mean_temp_01_90  \
    992            10.685833         3.641667   
    9114           10.562500         0.433333   
    6448           11.482500         3.655000   
    11990          12.545833         3.326667   
    12778          11.121667         0.128333   
    ...                  ...              ...   
    3783           11.343333         2.998333   
    1879           10.562500         0.433333   
    6341           10.685833         3.641667   
    5961           10.685833         3.641667   
    11891          11.121667         0.128333   

           mean_temp_to_av_precipitation_ratio_01_90  \
    992                                     0.114645   
    9114                                    0.001658   
    6448                                    0.112876   
    11990                                   0.133037   
    12778                                  -0.002261   
    ...                                          ...   
    3783                                    0.086351   
    1879                                    0.001658   
    6341                                    0.114645   
    5961                                    0.114645   
    11891                                  -0.002261   

           av_soil_temp_to_av_precipitation_ratio_01_90  \
    992                                        0.061731   
    9114                                       0.049119   
    6448                                       0.066315   
    11990                                      0.070945   
    12778                                      0.026377   
    ...                                             ...   
    3783                                       0.062780   
    1879                                       0.049119   
    6341                                       0.061731   
    5961                                       0.061731   
    11891                                      0.026377   

           sunshine_dur_to_av_precipitation_ratio_01_90  class  \
    992                                        1.357749      1   
    9114                                       2.046119      1   
    6448                                       1.279462      1   
    11990                                      2.026593      0   
    12778                                      2.701684      0   
    ...                                             ...    ...   
    3783                                       1.578486      1   
    1879                                       2.046119      0   
    6341                                       1.357749      1   
    5961                                       1.357749      0   
    11891                                      2.701684      0   

           av_precipitation_182_365_Missing  av_precipitation_182_365_high  \
    992                                   1                              0   
    9114                                  0                              1   
    6448                                  0                              0   
    11990                                 0                              0   
    12778                                 0                              1   
    ...                                 ...                            ...   
    3783                                  0                              0   
    1879                                  0                              1   
    6341                                  1                              0   
    5961                                  1                              0   
    11891                                 0                              1   

           av_precipitation_182_365_low  av_relative_humidity_182_365_71-76  \
    992                               0                                   0   
    9114                              0                                   0   
    6448                              1                                   0   
    11990                             1                                   1   
    12778                             0                                   0   
    ...                             ...                                 ...   
    3783                              1                                   1   
    1879                              0                                   0   
    6341                              0                                   0   
    5961                              0                                   0   
    11891                             0                                   0   

           av_relative_humidity_182_365_76-81  av_relative_humidity_182_365_81-87  \
    992                                     0                                   0   
    9114                                    0                                   1   
    6448                                    0                                   0   
    11990                                   0                                   0   
    12778                                   0                                   1   
    ...                                   ...                                 ...   
    3783                                    0                                   0   
    1879                                    0                                   1   
    6341                                    0                                   0   
    5961                                    0                                   0   
    11891                                   0                                   1   

           av_relative_humidity_182_365_Missing  av_relative_humidity_july_58-59  \
    992                                       1                                0   
    9114                                      0                                0   
    6448                                      1                                0   
    11990                                     0                                0   
    12778                                     0                                0   
    ...                                     ...                              ...   
    3783                                      0                                1   
    1879                                      0                                0   
    6341                                      1                                0   
    5961                                      1                                0   
    11891                                     0                                0   

           av_relative_humidity_july_59-63  av_relative_humidity_july_63-77  \
    992                                  0                                0   
    9114                                 0                                0   
    6448                                 0                                1   
    11990                                1                                0   
    12778                                0                                0   
    ...                                ...                              ...   
    3783                                 0                                0   
    1879                                 0                                0   
    6341                                 0                                0   
    5961                                 0                                0   
    11891                                0                                0   

           av_relative_humidity_july_77-81  av_relative_humidity_july_Missing  \
    992                                  0                                  1   
    9114                                 1                                  0   
    6448                                 0                                  0   
    11990                                0                                  0   
    12778                                1                                  0   
    ...                                ...                                ...   
    3783                                 0                                  0   
    1879                                 1                                  0   
    6341                                 0                                  1   
    5961                                 0                                  1   
    11891                                1                                  0   

           av_relative_humidity_oct_62-69  av_relative_humidity_sep_62-69  \
    992                                 1                               0   
    9114                                1                               1   
    6448                                1                               0   
    11990                               1                               1   
    12778                               1                               1   
    ...                               ...                             ...   
    3783                                1                               1   
    1879                                1                               1   
    6341                                1                               0   
    5961                                1                               0   
    11891                               1                               1   

           av_relative_humidity_sep_69-76  av_relative_humidity_sep_76-83  \
    992                                 0                               1   
    9114                                0                               0   
    6448                                0                               0   
    11990                               0                               0   
    12778                               0                               0   
    ...                               ...                             ...   
    3783                                0                               0   
    1879                                0                               0   
    6341                                0                               1   
    5961                                0                               1   
    11891                               0                               0   

           av_relative_humidity_sep_Missing  \
    992                                   0   
    9114                                  0   
    6448                                  1   
    11990                                 0   
    12778                                 0   
    ...                                 ...   
    3783                                  0   
    1879                                  0   
    6341                                  0   
    5961                                  0   
    11891                                 0   

           av_soil_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1        
    9114                                                   0        
    6448                                                   0        
    11990                                                  0        
    12778                                                  0        
    ...                                                  ...        
    3783                                                   0        
    1879                                                   0        
    6341                                                   1        
    5961                                                   1        
    11891                                                  0        

           av_soil_temp_to_av_precipitation_ratio_182_365_high  \
    992                                                    0     
    9114                                                   0     
    6448                                                   0     
    11990                                                  1     
    12778                                                  0     
    ...                                                  ...     
    3783                                                   0     
    1879                                                   0     
    6341                                                   0     
    5961                                                   0     
    11891                                                  0     

           av_soil_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                    0    
    9114                                                   1    
    6448                                                   0    
    11990                                                  0    
    12778                                                  1    
    ...                                                  ...    
    3783                                                   0    
    1879                                                   1    
    6341                                                   0    
    5961                                                   0    
    11891                                                  1    

           av_soil_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                    0    
    9114                                                   0    
    6448                                                   1    
    11990                                                  0    
    12778                                                  0    
    ...                                                  ...    
    3783                                                   1    
    1879                                                   0    
    6341                                                   0    
    5961                                                   0    
    11891                                                  0    

           mean_temp_to_av_precipitation_ratio_182_365_0.1-0.22  \
    992                                                    0      
    9114                                                   0      
    6448                                                   0      
    11990                                                  1      
    12778                                                  0      
    ...                                                  ...      
    3783                                                   0      
    1879                                                   0      
    6341                                                   0      
    5961                                                   0      
    11891                                                  0      

           mean_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1     
    9114                                                   0     
    6448                                                   0     
    11990                                                  0     
    12778                                                  0     
    ...                                                  ...     
    3783                                                   0     
    1879                                                   0     
    6341                                                   1     
    5961                                                   1     
    11891                                                  0     

           mean_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                  0   
    9114                                                 1   
    6448                                                 0   
    11990                                                0   
    12778                                                1   
    ...                                                ...   
    3783                                                 0   
    1879                                                 1   
    6341                                                 0   
    5961                                                 0   
    11891                                                1   

           mean_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                  0   
    9114                                                 0   
    6448                                                 1   
    11990                                                0   
    12778                                                0   
    ...                                                ...   
    3783                                                 1   
    1879                                                 0   
    6341                                                 0   
    5961                                                 0   
    11891                                                0   

           precipitation_sep_10-30  precipitation_sep_30-50  \
    992                          0                        0   
    9114                         0                        1   
    6448                         0                        1   
    11990                        1                        0   
    12778                        0                        1   
    ...                        ...                      ...   
    3783                         1                        0   
    1879                         0                        1   
    6341                         0                        0   
    5961                         0                        0   
    11891                        0                        1   

           precipitation_sep_50-70  precipitation_sep_70-90  \
    992                          0                        0   
    9114                         0                        0   
    6448                         0                        0   
    11990                        0                        0   
    12778                        0                        0   
    ...                        ...                      ...   
    3783                         0                        0   
    1879                         0                        0   
    6341                         0                        0   
    5961                         0                        0   
    11891                        0                        0   

           precipitation_sep_Missing  relative_precipitation_182_365_0-1  \
    992                            1                                   0   
    9114                           0                                   0   
    6448                           0                                   0   
    11990                          0                                   1   
    12778                          0                                   0   
    ...                          ...                                 ...   
    3783                           0                                   0   
    1879                           0                                   0   
    6341                           1                                   0   
    5961                           1                                   0   
    11891                          0                                   0   

           relative_precipitation_182_365_1-2  relative_precipitation_182_365_2-3  \
    992                                     0                                   0   
    9114                                    0                                   1   
    6448                                    1                                   0   
    11990                                   0                                   0   
    12778                                   0                                   1   
    ...                                   ...                                 ...   
    3783                                    1                                   0   
    1879                                    0                                   1   
    6341                                    0                                   0   
    5961                                    0                                   0   
    11891                                   0                                   1   

           relative_precipitation_182_365_Missing  \
    992                                         1   
    9114                                        0   
    6448                                        0   
    11990                                       0   
    12778                                       0   
    ...                                       ...   
    3783                                        0   
    1879                                        0   
    6341                                        1   
    5961                                        1   
    11891                                       0   

           sunshine_dur_to_av_precipitation_ratio_182_365_0-0.3  \
    992                                                    0      
    9114                                                   1      
    6448                                                   1      
    11990                                                  1      
    12778                                                  1      
    ...                                                  ...      
    3783                                                   1      
    1879                                                   1      
    6341                                                   0      
    5961                                                   0      
    11891                                                  1      

           sunshine_dur_to_av_precipitation_ratio_182_365_Missing  
    992                                                    1       
    9114                                                   0       
    6448                                                   0       
    11990                                                  0       
    12778                                                  0       
    ...                                                  ...       
    3783                                                   0       
    1879                                                   0       
    6341                                                   1       
    5961                                                   1       
    11891                                                  0       

    [14390 rows x 142 columns]

    #save final test_df on pc (keep for model validation only)
    #test_df.to_csv('cover_crop_test_df_final.csv')

    #create train_df 
    train_df = test_df
    train_df.head()

           ndvi_min_182_365  ndvi_max_182_365  ndvi_mean_182_365  \
    992                0.06              0.88               0.53   
    9114               0.43              0.75               0.56   
    6448               0.14              0.80               0.35   
    11990             -0.04              0.64               0.30   
    12778              0.12              0.58               0.38   

           ndvi_mean_var_182_365  ndvi_trend_196_273  ndvi_trend_213_258  \
    992                   0.0537              0.0000              0.0034   
    9114                  0.0090              0.0034              0.0033   
    6448                  0.0508             -0.0001              0.0001   
    11990                 0.0297             -0.0065             -0.0051   
    12778                 0.0247             -0.0001             -0.0020   

           ndvi_trend_274_332  ndvi_sum_232_272  ndvi_sum_278_348  \
    992               -0.0003              13.0              54.0   
    9114              -0.0029              28.0              36.0   
    6448               0.0083               6.0              35.0   
    11990              0.0008              11.0              12.0   
    12778             -0.0054              21.0              17.0   

           ndvi_sum_001_046  doy_ndvi_max_182_365  doy_ndvi_min_182_365  \
    992                31.0                 288.0                 273.0   
    9114               21.0                 268.0                 323.0   
    6448               28.0                 320.0                 200.0   
    11990              13.0                 182.0                 297.0   
    12778               9.0                 262.0                 334.0   

           rpearson_ts_sim_182_365  rpearson_ts_sim_1_120  \
    992                       0.86                   0.86   
    9114                     -0.37                  -0.62   
    6448                      0.75                   0.95   
    11990                    -0.82                  -0.74   
    12778                    -0.87                   0.49   

           doy_first_level_shift_182_365  number_level_shifts_182_365  \
    992                            280.0                          1.0   
    9114                           270.0                          3.0   
    6448                             0.0                          0.0   
    11990                          291.0                          2.0   
    12778                            0.0                          0.0   

           doy_first_level_shift_001_120  doy_changepoint_182_365  \
    992                              0.0                    276.0   
    9114                            58.0                    287.0   
    6448                             0.0                    283.0   
    11990                           79.0                    231.0   
    12778                          109.0                    296.0   

           doy_changepoint_001_120  min_temp_july  min_temp_aug  min_temp_sep  \
    992                       87.0           9.82         10.30          5.59   
    9114                      82.0          11.23          9.84          6.60   
    6448                      40.0          10.95         10.33          6.70   
    11990                     91.0          13.07         13.17          8.77   
    12778                     51.0          12.67         12.07          7.63   

           min_temp_oct  min_temp_nov  min_temp_dec  min_temp_jan  min_temp_feb  \
    992            5.36          0.44         -0.95         -0.82          0.57   
    9114           6.45          1.22         -0.03          0.18         -8.64   
    6448           3.64          0.98          1.72         -1.98         -0.89   
    11990          3.93          0.70          0.66         -2.61         -1.84   
    12778          6.52          1.09         -1.07         -0.79         -7.69   

           min_temp_march  max_temp_july  max_temp_aug  max_temp_sep  \
    992             -2.25      23.790001     25.510000     19.600000   
    9114            -3.34      23.040001     22.480000     17.730000   
    6448             1.85      26.799999     25.379999     20.969999   
    11990            0.86      28.440001     28.000000     22.969999   
    12778           -4.29      23.760000     24.030001     18.510000   

           max_temp_oct  max_temp_nov  max_temp_dec  max_temp_jan  max_temp_feb  \
    992           14.98          7.59          6.20          5.91          8.27   
    9114          15.11          7.81          5.27          6.11          1.27   
    6448          15.85          8.03          6.44          3.66          9.24   
    11990         16.25          8.23          6.36          3.39          9.04   
    12778         14.59          8.30          5.36          5.42          2.42   

           max_temp_march  av_relative_humidity_aug  av_relative_humidity_nov  \
    992             10.17                 69.599998                 90.489998   
    9114             7.02                 79.949997                 90.760002   
    6448            10.05                 67.370003                 88.510002   
    11990           11.12                 58.320000                 85.040001   
    12778            5.70                 76.620003                 92.180000   

           av_relative_humidity_dec  av_relative_humidity_jan  \
    992                   86.669998                 88.330002   
    9114                  89.169998                 89.089996   
    6448                  91.379997                 87.769997   
    11990                 88.300003                 86.120003   
    12778                 90.139999                 88.809998   

           av_relative_humidity_feb  av_relative_humidity_march  \
    992                   79.290001                   71.290001   
    9114                  81.730003                   80.150002   
    6448                  79.050003                   80.559998   
    11990                 72.540001                   76.889999   
    12778                 77.220001                   77.430000   

           precipitation_july  precipitation_aug  precipitation_oct  \
    992             69.099998          36.500000          72.199997   
    9114           158.199997          91.000000          54.099998   
    6448            41.700001          27.799999          40.099998   
    11990           51.900002          10.100000          12.500000   
    12778          144.300003          73.800003          74.599998   

           precipitation_nov  precipitation_dec  precipitation_jan  \
    992            36.400002          76.500000          39.599998   
    9114           79.300003          49.200001          84.900002   
    6448           13.100000         104.599998          83.500000   
    11990          15.400000          38.000000          51.599998   
    12778          62.299999          35.099998          58.400002   

           precipitation_feb  precipitation_march  av_soil_temp_july  \
    992           125.099998            52.099998          20.346640   
    9114           10.400000            37.400002          18.932528   
    6448           23.799999            78.699997          23.153091   
    11990          23.500000            59.900002          26.486828   
    12778           1.900000            52.500000          22.654167   

           av_soil_temp_aug  av_soil_temp_sep  av_soil_temp_oct  av_soil_temp_nov  \
    992           20.362904         15.681666         11.508737          5.924445   
    9114          18.329033         14.912084         11.951210          6.453472   
    6448          22.164381         16.522223         11.106989          5.841667   
    11990         25.511156         18.827917         10.582796          5.031111   
    12778         22.565994         15.948750         11.510080          5.809306   

           av_soil_temp_dec  av_soil_temp_jan  ...  mean_temp_march  \
    992            3.660081          3.244758  ...            3.960   
    9114           3.394624          3.566263  ...            1.840   
    6448           4.535349          2.118414  ...            5.950   
    11990          3.491667          1.461156  ...            5.990   
    12778          2.390591          2.156720  ...            0.705   

           min_temp_182_365  min_temp_01_90  max_temp_182_365  max_temp_01_90  \
    992            5.093333       -0.833333         16.278333        8.116667   
    9114           5.885000       -3.933333         15.240000        4.800000   
    6448           5.720000       -0.340000         17.245000        7.650000   
    11990          6.716667       -1.196667         18.375000        7.850000   
    12778          6.485000       -4.256667         15.758334        4.513333   

           av_relative_humidity_01_90  av_precipitation_01_90  \
    992                     79.636668               72.266665   
    9114                    83.656667               44.233334   
    6448                    82.459999               61.999999   
    11990                   78.516668               45.000000   
    12778                   81.153333               37.600001   

           av_soil_temp_182_365  av_soil_temp_01_90  av_soil_temp_sum_182_365  \
    992               12.914079            4.461100                 77.484472   
    9114              12.328825            2.172681                 73.972950   
    6448              13.887283            4.111559                 83.323700   
    11990             14.988579            3.192542                 89.931475   
    12778             13.479815            0.991793                 80.878888   

           av_soil_temp_sum_01_90  sunshine_duration_sum_182_365  \
    992                 13.383300                     800.929997   
    9114                 6.518044                     610.989996   
    6448                12.334678                     958.939985   
    11990                9.577626                    1099.549980   
    12778                2.975379                     782.700005   

           sunshine_duration_sum_01_90  av_sunshine_duration_182_365  \
    992                     294.359997                    133.488333   
    9114                    271.519999                    101.831666   
    6448                    237.979996                    159.823331   
    11990                   273.590004                    183.258330   
    12778                   304.749992                    130.450001   

           av_sunshine_duration_01_90  min_max_temp_ratio_182_365  \
    992                     98.119999                    0.312890   
    9114                    90.506666                    0.386155   
    6448                    79.326665                    0.331690   
    11990                   91.196668                    0.365533   
    12778                  101.583331                    0.411528   

           mean_temp_182_365  mean_temp_01_90  \
    992            10.685833         3.641667   
    9114           10.562500         0.433333   
    6448           11.482500         3.655000   
    11990          12.545833         3.326667   
    12778          11.121667         0.128333   

           mean_temp_to_av_precipitation_ratio_01_90  \
    992                                     0.114645   
    9114                                    0.001658   
    6448                                    0.112876   
    11990                                   0.133037   
    12778                                  -0.002261   

           av_soil_temp_to_av_precipitation_ratio_01_90  \
    992                                        0.061731   
    9114                                       0.049119   
    6448                                       0.066315   
    11990                                      0.070945   
    12778                                      0.026377   

           sunshine_dur_to_av_precipitation_ratio_01_90  class  \
    992                                        1.357749      1   
    9114                                       2.046119      1   
    6448                                       1.279462      1   
    11990                                      2.026593      0   
    12778                                      2.701684      0   

           av_precipitation_182_365_Missing  av_precipitation_182_365_high  \
    992                                   1                              0   
    9114                                  0                              1   
    6448                                  0                              0   
    11990                                 0                              0   
    12778                                 0                              1   

           av_precipitation_182_365_low  av_relative_humidity_182_365_71-76  \
    992                               0                                   0   
    9114                              0                                   0   
    6448                              1                                   0   
    11990                             1                                   1   
    12778                             0                                   0   

           av_relative_humidity_182_365_76-81  av_relative_humidity_182_365_81-87  \
    992                                     0                                   0   
    9114                                    0                                   1   
    6448                                    0                                   0   
    11990                                   0                                   0   
    12778                                   0                                   1   

           av_relative_humidity_182_365_Missing  av_relative_humidity_july_58-59  \
    992                                       1                                0   
    9114                                      0                                0   
    6448                                      1                                0   
    11990                                     0                                0   
    12778                                     0                                0   

           av_relative_humidity_july_59-63  av_relative_humidity_july_63-77  \
    992                                  0                                0   
    9114                                 0                                0   
    6448                                 0                                1   
    11990                                1                                0   
    12778                                0                                0   

           av_relative_humidity_july_77-81  av_relative_humidity_july_Missing  \
    992                                  0                                  1   
    9114                                 1                                  0   
    6448                                 0                                  0   
    11990                                0                                  0   
    12778                                1                                  0   

           av_relative_humidity_oct_62-69  av_relative_humidity_sep_62-69  \
    992                                 1                               0   
    9114                                1                               1   
    6448                                1                               0   
    11990                               1                               1   
    12778                               1                               1   

           av_relative_humidity_sep_69-76  av_relative_humidity_sep_76-83  \
    992                                 0                               1   
    9114                                0                               0   
    6448                                0                               0   
    11990                               0                               0   
    12778                               0                               0   

           av_relative_humidity_sep_Missing  \
    992                                   0   
    9114                                  0   
    6448                                  1   
    11990                                 0   
    12778                                 0   

           av_soil_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1        
    9114                                                   0        
    6448                                                   0        
    11990                                                  0        
    12778                                                  0        

           av_soil_temp_to_av_precipitation_ratio_182_365_high  \
    992                                                    0     
    9114                                                   0     
    6448                                                   0     
    11990                                                  1     
    12778                                                  0     

           av_soil_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                    0    
    9114                                                   1    
    6448                                                   0    
    11990                                                  0    
    12778                                                  1    

           av_soil_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                    0    
    9114                                                   0    
    6448                                                   1    
    11990                                                  0    
    12778                                                  0    

           mean_temp_to_av_precipitation_ratio_182_365_0.1-0.22  \
    992                                                    0      
    9114                                                   0      
    6448                                                   0      
    11990                                                  1      
    12778                                                  0      

           mean_temp_to_av_precipitation_ratio_182_365_Missing  \
    992                                                    1     
    9114                                                   0     
    6448                                                   0     
    11990                                                  0     
    12778                                                  0     

           mean_temp_to_av_precipitation_ratio_182_365_low  \
    992                                                  0   
    9114                                                 1   
    6448                                                 0   
    11990                                                0   
    12778                                                1   

           mean_temp_to_av_precipitation_ratio_182_365_mid  \
    992                                                  0   
    9114                                                 0   
    6448                                                 1   
    11990                                                0   
    12778                                                0   

           precipitation_sep_10-30  precipitation_sep_30-50  \
    992                          0                        0   
    9114                         0                        1   
    6448                         0                        1   
    11990                        1                        0   
    12778                        0                        1   

           precipitation_sep_50-70  precipitation_sep_70-90  \
    992                          0                        0   
    9114                         0                        0   
    6448                         0                        0   
    11990                        0                        0   
    12778                        0                        0   

           precipitation_sep_Missing  relative_precipitation_182_365_0-1  \
    992                            1                                   0   
    9114                           0                                   0   
    6448                           0                                   0   
    11990                          0                                   1   
    12778                          0                                   0   

           relative_precipitation_182_365_1-2  relative_precipitation_182_365_2-3  \
    992                                     0                                   0   
    9114                                    0                                   1   
    6448                                    1                                   0   
    11990                                   0                                   0   
    12778                                   0                                   1   

           relative_precipitation_182_365_Missing  \
    992                                         1   
    9114                                        0   
    6448                                        0   
    11990                                       0   
    12778                                       0   

           sunshine_dur_to_av_precipitation_ratio_182_365_0-0.3  \
    992                                                    0      
    9114                                                   1      
    6448                                                   1      
    11990                                                  1      
    12778                                                  1      

           sunshine_dur_to_av_precipitation_ratio_182_365_Missing  
    992                                                    1       
    9114                                                   0       
    6448                                                   0       
    11990                                                  0       
    12778                                                  0       

    [5 rows x 142 columns]

    def ClassificationMetrics(y, yhat):
        res = {'MSE': metrics.mean_squared_error(y,yhat),
               'RMSE': np.sqrt(metrics.mean_squared_error(y,yhat)),
               'MAE': metrics.mean_absolute_error(y,yhat),
               'MSLE': metrics.mean_squared_log_error(y,yhat),
               'RMSLE': np.sqrt(metrics.mean_squared_log_error(y,yhat)),
               'rsquered': metrics.r2_score(y,yhat)

              }
        print(res)
        return res

Logistic Regression

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=1234)

    print(X_train)
    print(y_train)

    [[0.28999999 0.49000001 0.43000001 ... 0.         1.         0.        ]
     [0.08       0.50999999 0.28       ... 0.         1.         0.        ]
     [0.25       0.92000002 0.52999997 ... 0.         1.         0.        ]
     ...
     [0.23       0.74000001 0.56       ... 1.         0.         1.        ]
     [0.31999999 0.85000002 0.60000002 ... 0.         1.         0.        ]
     [0.19       0.83999997 0.58999997 ... 0.         1.         0.        ]]
    13541    1
    13371    0
    238      1
    3529     1
    6715     1
            ..
    12607    0
    14346    0
    9221     0
    2734     0
    2878     1
    Name: class, Length: 11512, dtype: int64

    from sklearn.linear_model import LogisticRegression
    mod1=LogisticRegression()

    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(LogisticRegression(),X_train,y_train,cv=10,n_jobs=5)["test_score"]) #each part out of 10 is validated on the other part and the mean score is taken
    #the higher, the best

    0.7400117047977604

    mod1.fit(X_train,y_train)
    yhat=mod1.predict(X_test)

    ClassificationMetrics(y_test, yhat)
    #we will look on the RNSLE, the lower, the best

    {'MSE': 0.2571230020847811, 'RMSE': 0.5070729751079041, 'MAE': 0.2571230020847811, 'MSLE': 0.12353552129932907, 'RMSLE': 0.35147620303418703, 'rsquered': -0.02865295882866903}

    {'MSE': 0.2571230020847811,
     'RMSE': 0.5070729751079041,
     'MAE': 0.2571230020847811,
     'MSLE': 0.12353552129932907,
     'RMSLE': 0.35147620303418703,
     'rsquered': -0.02865295882866903}

    score= mod1.score(X_test,y_test)
    print(score)
    #the accuracy is 74%

    0.7428769979152189

let's try to improve the accuracy using hyperparameters and grid search

    #models and parameters
    from sklearn.model_selection import RepeatedStratifiedKFold
    from sklearn.model_selection import GridSearchCV
    mod1=LogisticRegression()
    solvers = ['newton-cg', 'lbfgs', 'liblinear']
    penalty = ['l2']
    c_values = [100, 10, 1.0, 0.1, 0.01]

    #define grid_search
    grid = dict(solver=solvers,penalty=penalty,C=c_values)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)
    grid_search = GridSearchCV(estimator=mod1, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit = grid_search.fit(X_train, y_train)

    #summarize results
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.809155 using {'C': 100, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.809155 (0.010633) with: {'C': 100, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.741284 (0.010771) with: {'C': 100, 'penalty': 'l2', 'solver': 'lbfgs'}
    0.804696 (0.009087) with: {'C': 100, 'penalty': 'l2', 'solver': 'liblinear'}
    0.809010 (0.010790) with: {'C': 10, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.740068 (0.012993) with: {'C': 10, 'penalty': 'l2', 'solver': 'lbfgs'}
    0.804870 (0.009559) with: {'C': 10, 'penalty': 'l2', 'solver': 'liblinear'}
    0.807736 (0.009834) with: {'C': 1.0, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.741776 (0.012057) with: {'C': 1.0, 'penalty': 'l2', 'solver': 'lbfgs'}
    0.804638 (0.009767) with: {'C': 1.0, 'penalty': 'l2', 'solver': 'liblinear'}
    0.805767 (0.009616) with: {'C': 0.1, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.740271 (0.011896) with: {'C': 0.1, 'penalty': 'l2', 'solver': 'lbfgs'}
    0.804696 (0.009782) with: {'C': 0.1, 'penalty': 'l2', 'solver': 'liblinear'}
    0.805362 (0.009757) with: {'C': 0.01, 'penalty': 'l2', 'solver': 'newton-cg'}
    0.744064 (0.010590) with: {'C': 0.01, 'penalty': 'l2', 'solver': 'lbfgs'}
    0.804986 (0.009807) with: {'C': 0.01, 'penalty': 'l2', 'solver': 'liblinear'}

    #best model gave 80% accuracy with 0.02 std
    #we can use it for new data classification: LogisticRegression(c=10, penality='l2', solver='newton-cg')

Ridge classifier

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=234)

    from sklearn.linear_model import RidgeClassifier
    mod2=RidgeClassifier()

    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(RidgeClassifier(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.8108065752003089

    #80% accuracy on the cross validate vs train_df

    mod2.fit(X_train,y_train)
    yhat=mod2.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.18693537178596248, 'RMSE': 0.4323602338166202, 'MAE': 0.18693537178596248, 'MSLE': 0.08981366278248516, 'RMSLE': 0.29968927705622894, 'rsquered': 0.25193337974636476}

    {'MSE': 0.18693537178596248,
     'RMSE': 0.4323602338166202,
     'MAE': 0.18693537178596248,
     'MSLE': 0.08981366278248516,
     'RMSLE': 0.29968927705622894,
     'rsquered': 0.25193337974636476}

    score2= mod2.score(X_test,y_test)
    print(score2)

    0.8130646282140376

    #81% accuracy
    #better accuracy with ridge classifier compared to logistic regression 

hyperparameter tuning

    #grid search using different regularization strength
    alpha= [0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9, 1.0]
    mod2=RidgeClassifier()
    grid= dict(alpha= alpha)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=111)
    grid_search = GridSearchCV(estimator=mod2, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit = grid_search.fit(X_train, y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.810457 using {'alpha': 0.4}
    0.809820 (0.010838) with: {'alpha': 0.1}
    0.810341 (0.010896) with: {'alpha': 0.2}
    0.810312 (0.011082) with: {'alpha': 0.3}
    0.810457 (0.011264) with: {'alpha': 0.4}
    0.810428 (0.011473) with: {'alpha': 0.5}
    0.810341 (0.011455) with: {'alpha': 0.6}
    0.810167 (0.011236) with: {'alpha': 0.7}
    0.810052 (0.011295) with: {'alpha': 0.8}
    0.810225 (0.011399) with: {'alpha': 0.9}
    0.810196 (0.011364) with: {'alpha': 1.0}

    #there is no improvment of the model using hyperparameter tuning

K-nearest neighbours

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=456)

    from sklearn.neighbors import KNeighborsClassifier
    mod3 = KNeighborsClassifier()

    #cross validation
    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(KNeighborsClassifier(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.6259566711313833

    #accuarcy using cross validation is lower than logistic regression and ridge classifier

    #fit model and predict using the test df
    mod3.fit(X_train,y_train)
    yhat=mod3.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.3703961084086171, 'RMSE': 0.6086017650390254, 'MAE': 0.3703961084086171, 'MSLE': 0.17795792662849294, 'RMSLE': 0.4218505975206067, 'rsquered': -0.48193081275235605}

    {'MSE': 0.3703961084086171,
     'RMSE': 0.6086017650390254,
     'MAE': 0.3703961084086171,
     'MSLE': 0.17795792662849294,
     'RMSLE': 0.4218505975206067,
     'rsquered': -0.48193081275235605}

    #model performance on test df
    score3= mod3.score(X_test,y_test)
    print(score3)

    0.6296038915913829

    #as we seen in cv of the train, model performance is not so good also on the test df

    #let's draw a scatter plot of the actual fit of the model and compare it to test, to see if the train is in the same trend as test and whether it is actual learning
    import seaborn as sns
    cmap = sns.cubehelix_palette(as_cmap=True)
    f, ax = plt.subplots()
    points = ax.scatter(X_test[:, 0], X_test[:, 1], c=yhat, s=50, cmap=cmap) #0 for length, 1 for diameter
    f.colorbar(points)
    plt.show()

[]

    cmap = sns.cubehelix_palette(as_cmap=True)
    f, ax = plt.subplots()
    points = ax.scatter(X_test[:, 0], X_test[:, 1], c=y_test, s=50, cmap=cmap) #0 for length, 1 for diameter
    f.colorbar(points)
    plt.show()

[]

    #trends seems alike, means the fitting model is actual learning
    #still accuracy is not so good

Hyperparameter tuning

    #let's make grid search
    #main parameters that has the most importance on model  performance are: #Neighbours, distance metric, weight (contribution of the neighbours)
    mod3= KNeighborsClassifier()
    n_neighbors = range(1, 21, 2)
    weights = ['uniform', 'distance']
    metric = ['euclidean', 'manhattan', 'minkowski']
    grid = dict(n_neighbors=n_neighbors,weights=weights,metric=metric)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)
    grid_search = GridSearchCV(estimator=mod3, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit= grid_search.fit(X_train,y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.703615 using {'metric': 'manhattan', 'n_neighbors': 19, 'weights': 'distance'}
    0.610089 (0.014647) with: {'metric': 'euclidean', 'n_neighbors': 1, 'weights': 'uniform'}
    0.610089 (0.014647) with: {'metric': 'euclidean', 'n_neighbors': 1, 'weights': 'distance'}
    0.620715 (0.016721) with: {'metric': 'euclidean', 'n_neighbors': 3, 'weights': 'uniform'}
    0.625233 (0.016311) with: {'metric': 'euclidean', 'n_neighbors': 3, 'weights': 'distance'}
    0.630648 (0.014416) with: {'metric': 'euclidean', 'n_neighbors': 5, 'weights': 'uniform'}
    0.635020 (0.013967) with: {'metric': 'euclidean', 'n_neighbors': 5, 'weights': 'distance'}
    0.635657 (0.012708) with: {'metric': 'euclidean', 'n_neighbors': 7, 'weights': 'uniform'}
    0.638755 (0.013456) with: {'metric': 'euclidean', 'n_neighbors': 7, 'weights': 'distance'}
    0.642113 (0.013751) with: {'metric': 'euclidean', 'n_neighbors': 9, 'weights': 'uniform'}
    0.645964 (0.016098) with: {'metric': 'euclidean', 'n_neighbors': 9, 'weights': 'distance'}
    0.645443 (0.015366) with: {'metric': 'euclidean', 'n_neighbors': 11, 'weights': 'uniform'}
    0.650076 (0.015748) with: {'metric': 'euclidean', 'n_neighbors': 11, 'weights': 'distance'}
    0.647614 (0.013864) with: {'metric': 'euclidean', 'n_neighbors': 13, 'weights': 'uniform'}
    0.653522 (0.014132) with: {'metric': 'euclidean', 'n_neighbors': 13, 'weights': 'distance'}
    0.649467 (0.013328) with: {'metric': 'euclidean', 'n_neighbors': 15, 'weights': 'uniform'}
    0.653782 (0.014386) with: {'metric': 'euclidean', 'n_neighbors': 15, 'weights': 'distance'}
    0.650742 (0.014743) with: {'metric': 'euclidean', 'n_neighbors': 17, 'weights': 'uniform'}
    0.654941 (0.014811) with: {'metric': 'euclidean', 'n_neighbors': 17, 'weights': 'distance'}
    0.652826 (0.014079) with: {'metric': 'euclidean', 'n_neighbors': 19, 'weights': 'uniform'}
    0.657344 (0.013983) with: {'metric': 'euclidean', 'n_neighbors': 19, 'weights': 'distance'}
    0.658994 (0.012654) with: {'metric': 'manhattan', 'n_neighbors': 1, 'weights': 'uniform'}
    0.658994 (0.012654) with: {'metric': 'manhattan', 'n_neighbors': 1, 'weights': 'distance'}
    0.672314 (0.013093) with: {'metric': 'manhattan', 'n_neighbors': 3, 'weights': 'uniform'}
    0.674978 (0.012372) with: {'metric': 'manhattan', 'n_neighbors': 3, 'weights': 'distance'}
    0.686386 (0.014109) with: {'metric': 'manhattan', 'n_neighbors': 5, 'weights': 'uniform'}
    0.688500 (0.013416) with: {'metric': 'manhattan', 'n_neighbors': 5, 'weights': 'distance'}
    0.691686 (0.013897) with: {'metric': 'manhattan', 'n_neighbors': 7, 'weights': 'uniform'}
    0.693278 (0.011921) with: {'metric': 'manhattan', 'n_neighbors': 7, 'weights': 'distance'}
    0.693654 (0.011759) with: {'metric': 'manhattan', 'n_neighbors': 9, 'weights': 'uniform'}
    0.695710 (0.013663) with: {'metric': 'manhattan', 'n_neighbors': 9, 'weights': 'distance'}
    0.697215 (0.012201) with: {'metric': 'manhattan', 'n_neighbors': 11, 'weights': 'uniform'}
    0.699735 (0.014257) with: {'metric': 'manhattan', 'n_neighbors': 11, 'weights': 'distance'}
    0.698113 (0.012485) with: {'metric': 'manhattan', 'n_neighbors': 13, 'weights': 'uniform'}
    0.702312 (0.014576) with: {'metric': 'manhattan', 'n_neighbors': 13, 'weights': 'distance'}
    0.697447 (0.013704) with: {'metric': 'manhattan', 'n_neighbors': 15, 'weights': 'uniform'}
    0.701385 (0.013502) with: {'metric': 'manhattan', 'n_neighbors': 15, 'weights': 'distance'}
    0.696636 (0.013227) with: {'metric': 'manhattan', 'n_neighbors': 17, 'weights': 'uniform'}
    0.702283 (0.013091) with: {'metric': 'manhattan', 'n_neighbors': 17, 'weights': 'distance'}
    0.699184 (0.013374) with: {'metric': 'manhattan', 'n_neighbors': 19, 'weights': 'uniform'}
    0.703615 (0.012808) with: {'metric': 'manhattan', 'n_neighbors': 19, 'weights': 'distance'}
    0.610089 (0.014647) with: {'metric': 'minkowski', 'n_neighbors': 1, 'weights': 'uniform'}
    0.610089 (0.014647) with: {'metric': 'minkowski', 'n_neighbors': 1, 'weights': 'distance'}
    0.620715 (0.016721) with: {'metric': 'minkowski', 'n_neighbors': 3, 'weights': 'uniform'}
    0.625233 (0.016311) with: {'metric': 'minkowski', 'n_neighbors': 3, 'weights': 'distance'}
    0.630648 (0.014416) with: {'metric': 'minkowski', 'n_neighbors': 5, 'weights': 'uniform'}
    0.635020 (0.013967) with: {'metric': 'minkowski', 'n_neighbors': 5, 'weights': 'distance'}
    0.635657 (0.012708) with: {'metric': 'minkowski', 'n_neighbors': 7, 'weights': 'uniform'}
    0.638755 (0.013456) with: {'metric': 'minkowski', 'n_neighbors': 7, 'weights': 'distance'}
    0.642113 (0.013751) with: {'metric': 'minkowski', 'n_neighbors': 9, 'weights': 'uniform'}
    0.645964 (0.016098) with: {'metric': 'minkowski', 'n_neighbors': 9, 'weights': 'distance'}
    0.645443 (0.015366) with: {'metric': 'minkowski', 'n_neighbors': 11, 'weights': 'uniform'}
    0.650076 (0.015748) with: {'metric': 'minkowski', 'n_neighbors': 11, 'weights': 'distance'}
    0.647614 (0.013864) with: {'metric': 'minkowski', 'n_neighbors': 13, 'weights': 'uniform'}
    0.653522 (0.014132) with: {'metric': 'minkowski', 'n_neighbors': 13, 'weights': 'distance'}
    0.649467 (0.013328) with: {'metric': 'minkowski', 'n_neighbors': 15, 'weights': 'uniform'}
    0.653782 (0.014386) with: {'metric': 'minkowski', 'n_neighbors': 15, 'weights': 'distance'}
    0.650742 (0.014743) with: {'metric': 'minkowski', 'n_neighbors': 17, 'weights': 'uniform'}
    0.654941 (0.014811) with: {'metric': 'minkowski', 'n_neighbors': 17, 'weights': 'distance'}
    0.652826 (0.014079) with: {'metric': 'minkowski', 'n_neighbors': 19, 'weights': 'uniform'}
    0.657344 (0.013983) with: {'metric': 'minkowski', 'n_neighbors': 19, 'weights': 'distance'}

    #best model has 70% accuracy,it's an inmprovment in regards to result without hyperparameter tuning
    #accuracy is less than ridge and logistic regression classification

Support vector machine

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=654)

    from sklearn.svm import SVC
    mod4=SVC()

    #cross validation
    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(SVC(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.6731241402403707

    #accuracy is 67%

    #fit model and predict using the test df
    mod4.fit(X_train,y_train)
    yhat=mod4.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.3255733148019458, 'RMSE': 0.5705903213356723, 'MAE': 0.3255733148019458, 'MSLE': 0.15642268034793422, 'RMSLE': 0.39550307248861444, 'rsquered': -0.302298919405499}

    {'MSE': 0.3255733148019458,
     'RMSE': 0.5705903213356723,
     'MAE': 0.3255733148019458,
     'MSLE': 0.15642268034793422,
     'RMSLE': 0.39550307248861444,
     'rsquered': -0.302298919405499}

    #model performance on test df
    score4= mod4.score(X_test,y_test)
    print(score4)

    0.6744266851980542

    #model is not so good, let's try hyperparameter tuning

hyperparameter tuning

    #many parameters possible, let's try the high importance using grid search
    mod4= SVC()
    kernel = ['poly', 'rbf', 'sigmoid'] #the main kernel of the model
    C = [50, 10, 1.0, 0.1, 0.01] #regularization/penality parameter
    gamma = ['scale'] #how far influences the calculation of plusible line on the separation
    grid= dict(kernel= kernel, C=C, gamma=gamma)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=111)
    grid_search = GridSearchCV(estimator=mod4, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit= grid_search.fit(X_train,y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.775683 using {'C': 50, 'gamma': 'scale', 'kernel': 'rbf'}
    0.706711 (0.013952) with: {'C': 50, 'gamma': 'scale', 'kernel': 'poly'}
    0.775683 (0.011971) with: {'C': 50, 'gamma': 'scale', 'kernel': 'rbf'}
    0.560256 (0.012039) with: {'C': 50, 'gamma': 'scale', 'kernel': 'sigmoid'}
    0.691278 (0.013199) with: {'C': 10, 'gamma': 'scale', 'kernel': 'poly'}
    0.757412 (0.012028) with: {'C': 10, 'gamma': 'scale', 'kernel': 'rbf'}
    0.560198 (0.011982) with: {'C': 10, 'gamma': 'scale', 'kernel': 'sigmoid'}
    0.619642 (0.013700) with: {'C': 1.0, 'gamma': 'scale', 'kernel': 'poly'}
    0.672600 (0.011400) with: {'C': 1.0, 'gamma': 'scale', 'kernel': 'rbf'}
    0.560227 (0.012071) with: {'C': 1.0, 'gamma': 'scale', 'kernel': 'sigmoid'}
    0.581711 (0.013865) with: {'C': 0.1, 'gamma': 'scale', 'kernel': 'poly'}
    0.651173 (0.011686) with: {'C': 0.1, 'gamma': 'scale', 'kernel': 'rbf'}
    0.562109 (0.011531) with: {'C': 0.1, 'gamma': 'scale', 'kernel': 'sigmoid'}
    0.565380 (0.015496) with: {'C': 0.01, 'gamma': 'scale', 'kernel': 'poly'}
    0.627547 (0.010800) with: {'C': 0.01, 'gamma': 'scale', 'kernel': 'rbf'}
    0.517663 (0.010980) with: {'C': 0.01, 'gamma': 'scale', 'kernel': 'sigmoid'}

    #best model with 77% accuracy, 2nd best model after ridge classifier

Bagged Decision Trees (Bagging)

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=423)

    from sklearn.ensemble import BaggingClassifier
    mod5= BaggingClassifier()

    #cross validation
    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(BaggingClassifier(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.8277462532580365

    #Accuracy is 82%, best model for now

    #fit model and predict using the test df
    mod5.fit(X_train,y_train)
    yhat=mod5.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.17303683113273105, 'RMSE': 0.41597695985803235, 'MAE': 0.17303683113273105, 'MSLE': 0.08313606703657549, 'RMSLE': 0.28833325690349265, 'rsquered': 0.3078513384494356}

    {'MSE': 0.17303683113273105,
     'RMSE': 0.41597695985803235,
     'MAE': 0.17303683113273105,
     'MSLE': 0.08313606703657549,
     'RMSLE': 0.28833325690349265,
     'rsquered': 0.3078513384494356}

    #model performance on test df
    score5= mod5.score(X_test,y_test)
    print(score5)

    0.826963168867269

hyperparameters tuning

    #the most important parameter is #trees/#estimators, let's try it using grid search
    mod5= BaggingClassifier()
    n_estimators = [10, 100, 1000]
    grid = dict(n_estimators=n_estimators)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=112)
    grid_search = GridSearchCV(estimator=mod5, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit= grid_search.fit(X_train,y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.848303 using {'n_estimators': 1000}
    0.829481 (0.010091) with: {'n_estimators': 10}
    0.846421 (0.009663) with: {'n_estimators': 100}
    0.848303 (0.009885) with: {'n_estimators': 1000}

    #84% accuracy, best model for now (and better than what the researcher achived without climate features> 82%)

Random Forest classifier

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=443)

    from sklearn.ensemble import RandomForestClassifier
    mod6= RandomForestClassifier(n_estimators=100)

    #cross validation
    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(RandomForestClassifier(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.8509355542282073

    #85% accuracy, better than Bagged decision trees

    #fit model and predict using the test df
    mod6.fit(X_train,y_train)
    yhat=mod6.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.1556636553161918, 'RMSE': 0.3945423365320784, 'MAE': 0.1556636553161918, 'MSLE': 0.0747890723541884, 'RMSLE': 0.27347590817874323, 'rsquered': 0.37710954487986836}

    {'MSE': 0.1556636553161918,
     'RMSE': 0.3945423365320784,
     'MAE': 0.1556636553161918,
     'MSLE': 0.0747890723541884,
     'RMSLE': 0.27347590817874323,
     'rsquered': 0.37710954487986836}

    #model performance on test df
    score6= mod6.score(X_test,y_test)
    print(score6)

    0.8443363446838082

Hyperparametrs fine-tuning

    mod6= RandomForestClassifier()
    n_estimators = [10, 100, 1000]
    max_features = ['sqrt', 'log2']
    criterion= ['gini','entropy','log_loss']
    grid = dict(n_estimators=n_estimators,max_features=max_features, criterion=criterion)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)
    grid_search = GridSearchCV(estimator=mod6, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit= grid_search.fit(X_train,y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.851140 using {'criterion': 'entropy', 'max_features': 'sqrt', 'n_estimators': 1000}
    0.830380 (0.010139) with: {'criterion': 'gini', 'max_features': 'sqrt', 'n_estimators': 10}
    0.850561 (0.010888) with: {'criterion': 'gini', 'max_features': 'sqrt', 'n_estimators': 100}
    0.851054 (0.010064) with: {'criterion': 'gini', 'max_features': 'sqrt', 'n_estimators': 1000}
    0.824936 (0.009228) with: {'criterion': 'gini', 'max_features': 'log2', 'n_estimators': 10}
    0.848476 (0.010557) with: {'criterion': 'gini', 'max_features': 'log2', 'n_estimators': 100}
    0.849548 (0.009428) with: {'criterion': 'gini', 'max_features': 'log2', 'n_estimators': 1000}
    0.829164 (0.010753) with: {'criterion': 'entropy', 'max_features': 'sqrt', 'n_estimators': 10}
    0.850040 (0.009584) with: {'criterion': 'entropy', 'max_features': 'sqrt', 'n_estimators': 100}
    0.851140 (0.010303) with: {'criterion': 'entropy', 'max_features': 'sqrt', 'n_estimators': 1000}
    0.828120 (0.012276) with: {'criterion': 'entropy', 'max_features': 'log2', 'n_estimators': 10}
    0.848795 (0.010268) with: {'criterion': 'entropy', 'max_features': 'log2', 'n_estimators': 100}
    0.849490 (0.009776) with: {'criterion': 'entropy', 'max_features': 'log2', 'n_estimators': 1000}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'sqrt', 'n_estimators': 10}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'sqrt', 'n_estimators': 100}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'sqrt', 'n_estimators': 1000}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'log2', 'n_estimators': 10}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'log2', 'n_estimators': 100}
    0.000000 (0.000000) with: {'criterion': 'log_loss', 'max_features': 'log2', 'n_estimators': 1000}

    #85% accuracy, best model for now

Gradient boosting machine (Stochastic boosting machine)

    X=train_df.loc[:,train_df.columns !='class'].values
    y=train_df['class']

    from sklearn.model_selection import train_test_split
    X_train,X_test,y_train,y_test= train_test_split(
    X, y, test_size=0.20, random_state=445)

    from sklearn.ensemble import GradientBoostingClassifier
    mod7= GradientBoostingClassifier()

    #cross validation
    from sklearn.model_selection import cross_validate
    np.mean(cross_validate(GradientBoostingClassifier(),X_train,y_train,cv=10,n_jobs=5)["test_score"])

    0.8366940884737909

    #83% accuracy using cross validation

    #fit model and predict using the test df
    mod7.fit(X_train,y_train)
    yhat=mod7.predict(X_test)

    ClassificationMetrics(y_test, yhat)

    {'MSE': 0.16435024322446143, 'RMSE': 0.40540133599244765, 'MAE': 0.16435024322446143, 'MSLE': 0.07896256969538196, 'RMSLE': 0.28100279303840014, 'rsquered': 0.3424720127941512}

    {'MSE': 0.16435024322446143,
     'RMSE': 0.40540133599244765,
     'MAE': 0.16435024322446143,
     'MSLE': 0.07896256969538196,
     'RMSLE': 0.28100279303840014,
     'rsquered': 0.3424720127941512}

    #model performance on test df
    score7= mod7.score(X_test,y_test)
    print(score7)

    0.8356497567755385

Hyperparameters fine-tuning

    mod7= GradientBoostingClassifier()
    n_estimators = [10, 100, 1000]
    learning_rate = [0.001, 0.01, 0.1]
    subsample = [0.5, 0.7, 1.0]
    max_depth = [3, 7, 9]
    grid = dict(learning_rate=learning_rate, n_estimators=n_estimators, subsample=subsample, max_depth=max_depth)
    cv = RepeatedStratifiedKFold(n_splits=10, n_repeats=3, random_state=1)
    grid_search = GridSearchCV(estimator=mod7, param_grid=grid, n_jobs=5, cv=cv, scoring='accuracy',error_score=0)
    grid_fit= grid_search.fit(X_train,y_train)

    #results summary
    print("Best: %f using %s" % (grid_fit.best_score_, grid_fit.best_params_))
    means = grid_fit.cv_results_['mean_test_score']
    stds = grid_fit.cv_results_['std_test_score']
    params = grid_fit.cv_results_['params']
    for mean, stdev, param in zip(means, stds, params):
        print("%f (%f) with: %r" % (mean, stdev, param))

    Best: 0.850446 using {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.5}
    0.808982 (0.011800) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.5}
    0.804032 (0.013191) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.7}
    0.794621 (0.010655) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 10, 'subsample': 1.0}
    0.809995 (0.010483) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
    0.809416 (0.010464) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.7}
    0.804726 (0.013940) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
    0.816858 (0.009076) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.5}
    0.815931 (0.009169) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.7}
    0.815757 (0.009496) with: {'learning_rate': 0.001, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 1.0}
    0.834057 (0.007414) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.5}
    0.833739 (0.008426) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.7}
    0.820739 (0.009275) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 10, 'subsample': 1.0}
    0.838459 (0.007502) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.5}
    0.836721 (0.007835) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.7}
    0.825313 (0.007976) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 100, 'subsample': 1.0}
    0.841643 (0.005997) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.5}
    0.840977 (0.007070) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.7}
    0.835824 (0.008724) with: {'learning_rate': 0.001, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 1.0}
    0.834115 (0.007430) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.5}
    0.834578 (0.009403) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.7}
    0.817467 (0.009937) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 10, 'subsample': 1.0}
    0.842223 (0.007268) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
    0.838632 (0.007456) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.7}
    0.819667 (0.009987) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 100, 'subsample': 1.0}
    0.843410 (0.006348) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.5}
    0.841760 (0.007181) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.7}
    0.832523 (0.008263) with: {'learning_rate': 0.001, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 1.0}
    0.807157 (0.012172) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.5}
    0.807390 (0.010798) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.7}
    0.804494 (0.013202) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 10, 'subsample': 1.0}
    0.816626 (0.008665) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
    0.815671 (0.009227) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.7}
    0.815815 (0.009251) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
    0.837908 (0.007765) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.5}
    0.837589 (0.007735) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.7}
    0.836923 (0.008258) with: {'learning_rate': 0.01, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 1.0}
    0.833651 (0.007789) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.5}
    0.834463 (0.008001) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.7}
    0.824936 (0.008484) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 10, 'subsample': 1.0}
    0.840572 (0.006947) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.5}
    0.840254 (0.005997) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.7}
    0.835621 (0.008430) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 100, 'subsample': 1.0}
    0.848911 (0.006845) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.5}
    0.849664 (0.007523) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.7}
    0.847492 (0.007551) with: {'learning_rate': 0.01, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 1.0}
    0.834259 (0.007644) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.5}
    0.835998 (0.007811) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.7}
    0.820130 (0.010100) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 10, 'subsample': 1.0}
    0.843207 (0.006281) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
    0.841585 (0.006759) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.7}
    0.832234 (0.008507) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 100, 'subsample': 1.0}
    0.850446 (0.007213) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.5}
    0.850185 (0.006821) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.7}
    0.846710 (0.008687) with: {'learning_rate': 0.01, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 1.0}
    0.814483 (0.010161) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.5}
    0.815091 (0.009616) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 10, 'subsample': 0.7}
    0.815526 (0.009119) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 10, 'subsample': 1.0}
    0.835678 (0.008923) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.5}
    0.836865 (0.008365) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 100, 'subsample': 0.7}
    0.836807 (0.008474) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 100, 'subsample': 1.0}
    0.839906 (0.007793) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.5}
    0.841527 (0.008884) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 0.7}
    0.842599 (0.008741) with: {'learning_rate': 0.1, 'max_depth': 3, 'n_estimators': 1000, 'subsample': 1.0}
    0.834144 (0.007546) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.5}
    0.835419 (0.007572) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 10, 'subsample': 0.7}
    0.834230 (0.008974) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 10, 'subsample': 1.0}
    0.842338 (0.005187) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.5}
    0.845494 (0.007950) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 100, 'subsample': 0.7}
    0.846363 (0.007429) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 100, 'subsample': 1.0}
    0.845002 (0.008640) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.5}
    0.846942 (0.007655) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 0.7}
    0.847811 (0.008290) with: {'learning_rate': 0.1, 'max_depth': 7, 'n_estimators': 1000, 'subsample': 1.0}
    0.836026 (0.008256) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.5}
    0.835070 (0.008871) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 10, 'subsample': 0.7}
    0.832089 (0.009685) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 10, 'subsample': 1.0}
    0.842512 (0.008980) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.5}
    0.844510 (0.006570) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 100, 'subsample': 0.7}
    0.845234 (0.007993) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 100, 'subsample': 1.0}
    0.846508 (0.008166) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.5}
    0.847753 (0.006945) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 0.7}
    0.849925 (0.006415) with: {'learning_rate': 0.1, 'max_depth': 9, 'n_estimators': 1000, 'subsample': 1.0}

#this model run for more than 24 hours, accuracy is 85%. same as random
forest classifier, which run much faster

#best model to use is random forest classifier
